
# CREDIT SCORECARD

Nguyễn Quang Minh

Bài viết thứ 2 nằm trong series về **Credit Scorecard** trong các tổ chức tín dụng. Trong bài này chúng ta cùng tìm hiểu cách ứng dụng các mô hình Machine trong chấm điểm tín dụng cũng như tìm ra mô hình tối ưu nhất. 

**Credit Scorecard** với mục tiêu là chấm điểm và phân loại khách hàng, cho phép đưa ra quyết định về chính sách can thiệp nhằm tối ưu hóa hiệu quả kinh doanh.

Thí dụ minh họa là một dữ liệu về thông tin cơ bản cũng như lịch sử hành vi của khách hàng thuộc nhóm trễ hạn nợ 2 tháng (B2_BOM).

Bài toán được giải quyết dựa trên dữ liệu của 9091 khách hàng, bao gồm nhiều thông tin, các thông tin đã được biến đổi cũng như thay đổi tên trường để đảm bảo lý do bảo mật.

Mục tiêu gồm : 

1. Giới thiệu các thuật toán machine learning cơ bản 
2. Turning model sử dụng GridSearchCV và tìm ra mô hình tối ưu


```python
import numpy as np
import pandas as pd

from sklearn.model_selection import GridSearchCV
from sklearn.ensemble import RandomForestClassifier
from sklearn.linear_model import LogisticRegression
from sklearn.naive_bayes import GaussianNB
from sklearn.neighbors import KNeighborsClassifier
from sklearn.svm import SVC
from sklearn.neural_network import MLPClassifier
from sklearn.ensemble import AdaBoostClassifier
from sklearn.tree import DecisionTreeClassifier

from sklearn.model_selection import train_test_split
import matplotlib.pyplot as plt
from sklearn.preprocessing import MinMaxScaler
```


```python
df.shape
```




    (9091, 162)




```python
df = pd.read_csv('credit_data.csv')
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>field0</th>
      <th>field1</th>
      <th>field2</th>
      <th>field3</th>
      <th>field4</th>
      <th>field5</th>
      <th>field6</th>
      <th>field7</th>
      <th>field8</th>
      <th>field9</th>
      <th>...</th>
      <th>field152</th>
      <th>field153</th>
      <th>field154</th>
      <th>field155</th>
      <th>field156</th>
      <th>field157</th>
      <th>field158</th>
      <th>field159</th>
      <th>field160</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.380586</td>
      <td>0.703704</td>
      <td>0.000000</td>
      <td>-1.0</td>
      <td>0.015873</td>
      <td>-0.433210</td>
      <td>0.738841</td>
      <td>-0.90</td>
      <td>-0.989333</td>
      <td>-0.833333</td>
      <td>...</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.157330</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>-1.0</td>
      <td>-0.174603</td>
      <td>-0.247485</td>
      <td>0.014493</td>
      <td>-0.45</td>
      <td>-0.986667</td>
      <td>-1.000000</td>
      <td>...</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.278147</td>
      <td>0.703704</td>
      <td>0.333333</td>
      <td>1.0</td>
      <td>0.206349</td>
      <td>-0.324409</td>
      <td>0.217101</td>
      <td>-0.85</td>
      <td>-0.980000</td>
      <td>-0.666667</td>
      <td>...</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.958365</td>
      <td>0.111111</td>
      <td>0.222222</td>
      <td>1.0</td>
      <td>-0.206349</td>
      <td>-0.443572</td>
      <td>0.449275</td>
      <td>0.10</td>
      <td>-0.990667</td>
      <td>-0.166667</td>
      <td>...</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.696864</td>
      <td>-0.111111</td>
      <td>-0.166667</td>
      <td>-1.0</td>
      <td>-0.079365</td>
      <td>-0.758473</td>
      <td>0.971014</td>
      <td>-0.95</td>
      <td>-0.988000</td>
      <td>-1.000000</td>
      <td>...</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 162 columns</p>
</div>




```python
df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 9091 entries, 0 to 9090
    Columns: 162 entries, field0 to label
    dtypes: float64(161), int64(1)
    memory usage: 11.2 MB
    


```python
X = df.drop(['label'], axis=1)
y = df['label']

X_train, X_test, y_train, y_test = train_test_split(X, y,
                                                    test_size=0.3,
                                                    random_state = 15,
                                                    stratify = y)
```


```python
lassifiers = [
    [GridSearchCV(estimator=KNeighborsClassifier(n_jobs=-1), param_grid={
        'n_neighbors': [1, 3, 5, 7, 9, 11, 15, 20]
    }, n_jobs=-1), "KNN"],
    [GridSearchCV(estimator=SVC(), param_grid={
        'kernel': ['linear', 'rbf'],
        'C': [0.0001, 0.001, 0.01, 0.1, 1, 10, 100, 1000, 10000],
        'gamma': [0.0001, 0.001, 0.01, 0.1, 1, 10, 100, 1000, 10000]
    }, n_jobs=-1), "SVM"],
    [GridSearchCV(estimator=RandomForestClassifier(n_jobs=-1), param_grid={
        'n_estimators': [200, 500, 1000, 5000, 10000],
        'max_features': ['auto', 'sqrt', 'log2'],
        'max_depth': [4, 5, 6, 7, 8],
        'criterion': ['gini', 'entropy']
    }, n_jobs=-1), "RF"],
    [GridSearchCV(estimator=MLPClassifier(), param_grid={
        'solver': ['lbfgs'],
        'max_iter': [1000, 1100, 1200, 1300, 1400, 1500, 1600, 1700,
                     1800, 1900, 2000],
        'alpha': 10.0 ** -np.arange(1, 10),
        'hidden_layer_sizes': np.arange(10, 15),
        'random_state': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
    }, n_jobs=-1), "MLP"],
    [GridSearchCV(estimator=AdaBoostClassifier(base_estimator=DecisionTreeClassifier()), param_grid={
        'n_estimators': (1, 2, 5, 10),
        'base_estimator__max_depth': (1, 2, 5, 8),
        'algorithm': ('SAMME', 'SAMME.R')
    }, n_jobs=-1), "Ada"]
]
```


```python

```
