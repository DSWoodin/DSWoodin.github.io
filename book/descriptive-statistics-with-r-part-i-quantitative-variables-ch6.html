<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>An introduction to R for McGill Epidemiology and Public Health students</title>
  <meta name="description" content="Introduction to R for McGill Epidemiology and Public Health students">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="An introduction to R for McGill Epidemiology and Public Health students" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Introduction to R for McGill Epidemiology and Public Health students" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="An introduction to R for McGill Epidemiology and Public Health students" />
  
  <meta name="twitter:description" content="Introduction to R for McGill Epidemiology and Public Health students" />
  

<meta name="author" content="Fei Wang &amp; Jay Brophy">


<meta name="date" content="2018-01-05">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="base-graphics-with-r-ch5.html">
<link rel="next" href="descriptive-statistics-with-r-part-ii-categorical-variables-and-ggplot.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="an-overview-of-r-part-i-ch2.html"><a href="an-overview-of-r-part-i-ch2.html"><i class="fa fa-check"></i><b>2</b> An overview of R: part I {ch2}</a><ul>
<li class="chapter" data-level="2.1" data-path="an-overview-of-r-part-i-ch2.html"><a href="an-overview-of-r-part-i-ch2.html#basic-computations-in-r"><i class="fa fa-check"></i><b>2.1</b> Basic computations in R</a></li>
<li class="chapter" data-level="2.2" data-path="an-overview-of-r-part-i-ch2.html"><a href="an-overview-of-r-part-i-ch2.html#create-an-object"><i class="fa fa-check"></i><b>2.2</b> Create an object</a></li>
<li class="chapter" data-level="2.3" data-path="an-overview-of-r-part-i-ch2.html"><a href="an-overview-of-r-part-i-ch2.html#operators"><i class="fa fa-check"></i><b>2.3</b> Operators</a><ul>
<li class="chapter" data-level="2.3.1" data-path="an-overview-of-r-part-i-ch2.html"><a href="an-overview-of-r-part-i-ch2.html#arithmetic-operators"><i class="fa fa-check"></i><b>2.3.1</b> 2.3.1 Arithmetic operators</a></li>
<li class="chapter" data-level="2.3.2" data-path="an-overview-of-r-part-i-ch2.html"><a href="an-overview-of-r-part-i-ch2.html#relational-operators"><i class="fa fa-check"></i><b>2.3.2</b> Relational operators</a></li>
<li class="chapter" data-level="2.3.3" data-path="an-overview-of-r-part-i-ch2.html"><a href="an-overview-of-r-part-i-ch2.html#logical-operators"><i class="fa fa-check"></i><b>2.3.3</b> Logical operators</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="an-overview-of-r-part-i-ch2.html"><a href="an-overview-of-r-part-i-ch2.html#generate-data"><i class="fa fa-check"></i><b>2.4</b> Generate data</a><ul>
<li class="chapter" data-level="2.4.1" data-path="an-overview-of-r-part-i-ch2.html"><a href="an-overview-of-r-part-i-ch2.html#regular-sequences"><i class="fa fa-check"></i><b>2.4.1</b> Regular sequences</a></li>
<li class="chapter" data-level="2.4.2" data-path="an-overview-of-r-part-i-ch2.html"><a href="an-overview-of-r-part-i-ch2.html#random-sequences"><i class="fa fa-check"></i><b>2.4.2</b> Random sequences</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="an-overview-of-r-part-i-ch2.html"><a href="an-overview-of-r-part-i-ch2.html#data-types"><i class="fa fa-check"></i><b>2.5</b> Data types</a><ul>
<li class="chapter" data-level="2.5.1" data-path="an-overview-of-r-part-i-ch2.html"><a href="an-overview-of-r-part-i-ch2.html#vectors"><i class="fa fa-check"></i><b>2.5.1</b> Vectors</a></li>
<li class="chapter" data-level="2.5.2" data-path="an-overview-of-r-part-i-ch2.html"><a href="an-overview-of-r-part-i-ch2.html#lists"><i class="fa fa-check"></i><b>2.5.2</b> Lists</a></li>
<li class="chapter" data-level="2.5.3" data-path="an-overview-of-r-part-i-ch2.html"><a href="an-overview-of-r-part-i-ch2.html#factors"><i class="fa fa-check"></i><b>2.5.3</b> Factors</a></li>
<li class="chapter" data-level="2.5.4" data-path="an-overview-of-r-part-i-ch2.html"><a href="an-overview-of-r-part-i-ch2.html#matrices"><i class="fa fa-check"></i><b>2.5.4</b> Matrices</a></li>
<li class="chapter" data-level="2.5.5" data-path="an-overview-of-r-part-i-ch2.html"><a href="an-overview-of-r-part-i-ch2.html#arrays"><i class="fa fa-check"></i><b>2.5.5</b> Arrays</a></li>
<li class="chapter" data-level="2.5.6" data-path="an-overview-of-r-part-i-ch2.html"><a href="an-overview-of-r-part-i-ch2.html#data-frames"><i class="fa fa-check"></i><b>2.5.6</b> Data Frames</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="an-overview-of-r-part-ii-ch3.html"><a href="an-overview-of-r-part-ii-ch3.html"><i class="fa fa-check"></i><b>3</b> An overview of R: Part II {ch3}</a><ul>
<li class="chapter" data-level="3.1" data-path="an-overview-of-r-part-ii-ch3.html"><a href="an-overview-of-r-part-ii-ch3.html#assess-the-values-of-an-object"><i class="fa fa-check"></i><b>3.1</b> Assess the values of an object</a><ul>
<li class="chapter" data-level="3.1.1" data-path="an-overview-of-r-part-ii-ch3.html"><a href="an-overview-of-r-part-ii-ch3.html#using-the-index-system"><i class="fa fa-check"></i><b>3.1.1</b> Using the index system</a></li>
<li class="chapter" data-level="3.1.2" data-path="an-overview-of-r-part-ii-ch3.html"><a href="an-overview-of-r-part-ii-ch3.html#using-the-names"><i class="fa fa-check"></i><b>3.1.2</b> Using the names</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="an-overview-of-r-part-ii-ch3.html"><a href="an-overview-of-r-part-ii-ch3.html#get-the-data-into-r"><i class="fa fa-check"></i><b>3.2</b> Get the data into R</a><ul>
<li class="chapter" data-level="3.2.1" data-path="an-overview-of-r-part-ii-ch3.html"><a href="an-overview-of-r-part-ii-ch3.html#direct-data-entering"><i class="fa fa-check"></i><b>3.2.1</b> Direct data entering</a></li>
<li class="chapter" data-level="3.2.2" data-path="an-overview-of-r-part-ii-ch3.html"><a href="an-overview-of-r-part-ii-ch3.html#use-dataset-that-come-with-r-or-r-packages"><i class="fa fa-check"></i><b>3.2.2</b> Use dataset that come with R or R packages</a></li>
<li class="chapter" data-level="3.2.3" data-path="an-overview-of-r-part-ii-ch3.html"><a href="an-overview-of-r-part-ii-ch3.html#read-in-data-files"><i class="fa fa-check"></i><b>3.2.3</b> Read in data files</a></li>
<li class="chapter" data-level="3.2.4" data-path="an-overview-of-r-part-ii-ch3.html"><a href="an-overview-of-r-part-ii-ch3.html#read-in-data-from-the-clipboard"><i class="fa fa-check"></i><b>3.2.4</b> Read in data from the clipboard</a></li>
<li class="chapter" data-level="3.2.5" data-path="an-overview-of-r-part-ii-ch3.html"><a href="an-overview-of-r-part-ii-ch3.html#read-in-remote-data"><i class="fa fa-check"></i><b>3.2.5</b> Read in remote data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="an-overview-of-r-part-ii-ch3.html"><a href="an-overview-of-r-part-ii-ch3.html#export-data"><i class="fa fa-check"></i><b>3.3</b> Export data</a></li>
<li class="chapter" data-level="3.4" data-path="an-overview-of-r-part-ii-ch3.html"><a href="an-overview-of-r-part-ii-ch3.html#save-and-load-data-in-r"><i class="fa fa-check"></i><b>3.4</b> Save and load data in R</a></li>
<li class="chapter" data-level="3.5" data-path="an-overview-of-r-part-ii-ch3.html"><a href="an-overview-of-r-part-ii-ch3.html#view-data"><i class="fa fa-check"></i><b>3.5</b> View data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-management-part-i-ch4.html"><a href="data-management-part-i-ch4.html"><i class="fa fa-check"></i><b>4</b> Data management: Part I {ch4}</a><ul>
<li class="chapter" data-level="4.1" data-path="data-management-part-i-ch4.html"><a href="data-management-part-i-ch4.html#control-structure"><i class="fa fa-check"></i><b>4.1</b> Control structure</a><ul>
<li class="chapter" data-level="4.1.1" data-path="data-management-part-i-ch4.html"><a href="data-management-part-i-ch4.html#for-loop"><i class="fa fa-check"></i><b>4.1.1</b> For loop</a></li>
<li class="chapter" data-level="4.1.2" data-path="data-management-part-i-ch4.html"><a href="data-management-part-i-ch4.html#while-loop"><i class="fa fa-check"></i><b>4.1.2</b> While Loop</a></li>
<li class="chapter" data-level="4.1.3" data-path="data-management-part-i-ch4.html"><a href="data-management-part-i-ch4.html#if-else-loop"><i class="fa fa-check"></i><b>4.1.3</b> If-else Loop</a></li>
<li class="chapter" data-level="4.1.4" data-path="data-management-part-i-ch4.html"><a href="data-management-part-i-ch4.html#repeat-loop"><i class="fa fa-check"></i><b>4.1.4</b> Repeat Loop</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-management-part-i-ch4.html"><a href="data-management-part-i-ch4.html#missing-values"><i class="fa fa-check"></i><b>4.2</b> Missing values</a></li>
<li class="chapter" data-level="4.3" data-path="data-management-part-i-ch4.html"><a href="data-management-part-i-ch4.html#dates"><i class="fa fa-check"></i><b>4.3</b> Dates</a></li>
<li class="chapter" data-level="4.4" data-path="data-management-part-i-ch4.html"><a href="data-management-part-i-ch4.html#common-useful-functions"><i class="fa fa-check"></i><b>4.4</b> Common useful functions</a><ul>
<li class="chapter" data-level="4.4.1" data-path="data-management-part-i-ch4.html"><a href="data-management-part-i-ch4.html#numeric-functions"><i class="fa fa-check"></i><b>4.4.1</b> Numeric functions</a></li>
<li class="chapter" data-level="4.4.2" data-path="data-management-part-i-ch4.html"><a href="data-management-part-i-ch4.html#character-functions"><i class="fa fa-check"></i><b>4.4.2</b> Character Functions</a></li>
<li class="chapter" data-level="4.4.3" data-path="data-management-part-i-ch4.html"><a href="data-management-part-i-ch4.html#apply-functions-over-a-list-array-dataframe-or-matrix"><i class="fa fa-check"></i><b>4.4.3</b> Apply functions over a list, array, dataframe or matrix</a></li>
<li class="chapter" data-level="4.4.4" data-path="data-management-part-i-ch4.html"><a href="data-management-part-i-ch4.html#other-useful-functions"><i class="fa fa-check"></i><b>4.4.4</b> Other useful functions</a></li>
<li class="chapter" data-level="4.4.5" data-path="data-management-part-i-ch4.html"><a href="data-management-part-i-ch4.html#write-functions"><i class="fa fa-check"></i><b>4.4.5</b> Write functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-managements-part-ii-reshape-data-ch4.html"><a href="data-managements-part-ii-reshape-data-ch4.html"><i class="fa fa-check"></i><b>5</b> Data managements: Part II- Reshape data {ch4}</a><ul>
<li class="chapter" data-level="5.1" data-path="data-managements-part-ii-reshape-data-ch4.html"><a href="data-managements-part-ii-reshape-data-ch4.html#subset-data"><i class="fa fa-check"></i><b>5.1</b> Subset Data</a><ul>
<li class="chapter" data-level="5.1.1" data-path="data-managements-part-ii-reshape-data-ch4.html"><a href="data-managements-part-ii-reshape-data-ch4.html#select-variables"><i class="fa fa-check"></i><b>5.1.1</b> Select variables</a></li>
<li class="chapter" data-level="5.1.2" data-path="data-managements-part-ii-reshape-data-ch4.html"><a href="data-managements-part-ii-reshape-data-ch4.html#exclude-variables"><i class="fa fa-check"></i><b>5.1.2</b> Exclude variables</a></li>
<li class="chapter" data-level="5.1.3" data-path="data-managements-part-ii-reshape-data-ch4.html"><a href="data-managements-part-ii-reshape-data-ch4.html#select-observations"><i class="fa fa-check"></i><b>5.1.3</b> Select Observations</a></li>
<li class="chapter" data-level="5.1.4" data-path="data-managements-part-ii-reshape-data-ch4.html"><a href="data-managements-part-ii-reshape-data-ch4.html#select-both-variables-and-observations"><i class="fa fa-check"></i><b>5.1.4</b> Select both variables and observations</a></li>
<li class="chapter" data-level="5.1.5" data-path="data-managements-part-ii-reshape-data-ch4.html"><a href="data-managements-part-ii-reshape-data-ch4.html#keep-or-delete-variables-using-dplyr-function"><i class="fa fa-check"></i><b>5.1.5</b> Keep or delete variables using dplyr function</a></li>
<li class="chapter" data-level="5.1.6" data-path="data-managements-part-ii-reshape-data-ch4.html"><a href="data-managements-part-ii-reshape-data-ch4.html#keepdrop-variables-by-name-pattern"><i class="fa fa-check"></i><b>5.1.6</b> Keep/drop variables by name pattern</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-managements-part-ii-reshape-data-ch4.html"><a href="data-managements-part-ii-reshape-data-ch4.html#merge-data"><i class="fa fa-check"></i><b>5.2</b> Merge Data</a><ul>
<li class="chapter" data-level="5.2.1" data-path="data-managements-part-ii-reshape-data-ch4.html"><a href="data-managements-part-ii-reshape-data-ch4.html#add-casesobservations-to-a-dataset"><i class="fa fa-check"></i><b>5.2.1</b> Add cases/observations to a dataset</a></li>
<li class="chapter" data-level="5.2.2" data-path="data-managements-part-ii-reshape-data-ch4.html"><a href="data-managements-part-ii-reshape-data-ch4.html#merge-data-frames"><i class="fa fa-check"></i><b>5.2.2</b> Merge Data Frames</a></li>
<li class="chapter" data-level="5.2.3" data-path="data-managements-part-ii-reshape-data-ch4.html"><a href="data-managements-part-ii-reshape-data-ch4.html#add-more-variables-to-a-dataset"><i class="fa fa-check"></i><b>5.2.3</b> Add more variables to a dataset</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="data-managements-part-ii-reshape-data-ch4.html"><a href="data-managements-part-ii-reshape-data-ch4.html#the-reshape-package"><i class="fa fa-check"></i><b>5.3</b> The Reshape package</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="base-graphics-with-r-ch5.html"><a href="base-graphics-with-r-ch5.html"><i class="fa fa-check"></i><b>6</b> Base Graphics with R {ch5}</a><ul>
<li class="chapter" data-level="6.1" data-path="base-graphics-with-r-ch5.html"><a href="base-graphics-with-r-ch5.html#graphical-functions"><i class="fa fa-check"></i><b>6.1</b> Graphical functions</a><ul>
<li class="chapter" data-level="6.1.1" data-path="base-graphics-with-r-ch5.html"><a href="base-graphics-with-r-ch5.html#high-level-graphical-functions"><i class="fa fa-check"></i><b>6.1.1</b> (1) High-level graphical functions</a></li>
<li class="chapter" data-level="6.1.2" data-path="base-graphics-with-r-ch5.html"><a href="base-graphics-with-r-ch5.html#low-level-functions"><i class="fa fa-check"></i><b>6.1.2</b> (2) Low-level functions</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="base-graphics-with-r-ch5.html"><a href="base-graphics-with-r-ch5.html#graphical-parameters"><i class="fa fa-check"></i><b>6.2</b> Graphical parameters</a><ul>
<li class="chapter" data-level="6.2.1" data-path="base-graphics-with-r-ch5.html"><a href="base-graphics-with-r-ch5.html#specify-within-the-high-level-function"><i class="fa fa-check"></i><b>6.2.1</b> 6.2.1 Specify within the high-level function</a></li>
<li class="chapter" data-level="6.2.2" data-path="base-graphics-with-r-ch5.html"><a href="base-graphics-with-r-ch5.html#function-par"><i class="fa fa-check"></i><b>6.2.2</b> Function par()</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="base-graphics-with-r-ch5.html"><a href="base-graphics-with-r-ch5.html#multiple-plots-on-the-one-page"><i class="fa fa-check"></i><b>6.3</b> Multiple plots on the one page</a><ul>
<li class="chapter" data-level="6.3.1" data-path="base-graphics-with-r-ch5.html"><a href="base-graphics-with-r-ch5.html#function-layout"><i class="fa fa-check"></i><b>6.3.1</b> Function layout()</a></li>
<li class="chapter" data-level="6.3.2" data-path="base-graphics-with-r-ch5.html"><a href="base-graphics-with-r-ch5.html#function-par-1"><i class="fa fa-check"></i><b>6.3.2</b> Function par()</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="base-graphics-with-r-ch5.html"><a href="base-graphics-with-r-ch5.html#save-a-plot"><i class="fa fa-check"></i><b>6.4</b> Save a plot</a><ul>
<li class="chapter" data-level="6.4.1" data-path="base-graphics-with-r-ch5.html"><a href="base-graphics-with-r-ch5.html#save-plots-by-menu-click"><i class="fa fa-check"></i><b>6.4.1</b> Save plots by menu click</a></li>
<li class="chapter" data-level="6.4.2" data-path="base-graphics-with-r-ch5.html"><a href="base-graphics-with-r-ch5.html#save-plots-using-functions"><i class="fa fa-check"></i><b>6.4.2</b> Save plots using functions</a></li>
<li class="chapter" data-level="6.4.3" data-path="base-graphics-with-r-ch5.html"><a href="base-graphics-with-r-ch5.html#a-common-method"><i class="fa fa-check"></i><b>6.4.3</b> (1) A common method</a></li>
<li class="chapter" data-level="6.4.4" data-path="base-graphics-with-r-ch5.html"><a href="base-graphics-with-r-ch5.html#another-option"><i class="fa fa-check"></i><b>6.4.4</b> (2)Another option</a></li>
<li class="chapter" data-level="6.4.5" data-path="base-graphics-with-r-ch5.html"><a href="base-graphics-with-r-ch5.html#saving-plots-in-a-loop"><i class="fa fa-check"></i><b>6.4.5</b> (3) Saving plots in a loop</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="descriptive-statistics-with-r-part-i-quantitative-variables-ch6.html"><a href="descriptive-statistics-with-r-part-i-quantitative-variables-ch6.html"><i class="fa fa-check"></i><b>7</b> Descriptive statistics with R: Part I-Quantitative variables {ch6}</a><ul>
<li class="chapter" data-level="7.1" data-path="descriptive-statistics-with-r-part-i-quantitative-variables-ch6.html"><a href="descriptive-statistics-with-r-part-i-quantitative-variables-ch6.html#for-the-whole-dataset"><i class="fa fa-check"></i><b>7.1</b> For the whole dataset</a></li>
<li class="chapter" data-level="7.2" data-path="descriptive-statistics-with-r-part-i-quantitative-variables-ch6.html"><a href="descriptive-statistics-with-r-part-i-quantitative-variables-ch6.html#for-a-single-quantitative-variable"><i class="fa fa-check"></i><b>7.2</b> For a single quantitative variable</a><ul>
<li class="chapter" data-level="7.2.1" data-path="descriptive-statistics-with-r-part-i-quantitative-variables-ch6.html"><a href="descriptive-statistics-with-r-part-i-quantitative-variables-ch6.html#numerical-representation"><i class="fa fa-check"></i><b>7.2.1</b> Numerical representation</a></li>
<li class="chapter" data-level="7.2.2" data-path="descriptive-statistics-with-r-part-i-quantitative-variables-ch6.html"><a href="descriptive-statistics-with-r-part-i-quantitative-variables-ch6.html#graphical-representation"><i class="fa fa-check"></i><b>7.2.2</b> Graphical representation</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="descriptive-statistics-with-r-part-i-quantitative-variables-ch6.html"><a href="descriptive-statistics-with-r-part-i-quantitative-variables-ch6.html#for-a-quantitative-variable-by-groups"><i class="fa fa-check"></i><b>7.3</b> For a quantitative variable by groups</a><ul>
<li class="chapter" data-level="7.3.1" data-path="descriptive-statistics-with-r-part-i-quantitative-variables-ch6.html"><a href="descriptive-statistics-with-r-part-i-quantitative-variables-ch6.html#numerical-representation-1"><i class="fa fa-check"></i><b>7.3.1</b> Numerical representation</a></li>
<li class="chapter" data-level="7.3.2" data-path="descriptive-statistics-with-r-part-i-quantitative-variables-ch6.html"><a href="descriptive-statistics-with-r-part-i-quantitative-variables-ch6.html#graphical-representation-1"><i class="fa fa-check"></i><b>7.3.2</b> Graphical representation</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="descriptive-statistics-with-r-part-i-quantitative-variables-ch6.html"><a href="descriptive-statistics-with-r-part-i-quantitative-variables-ch6.html#for-two-quantitative-variables"><i class="fa fa-check"></i><b>7.4</b> For two quantitative variables</a><ul>
<li class="chapter" data-level="7.4.1" data-path="descriptive-statistics-with-r-part-i-quantitative-variables-ch6.html"><a href="descriptive-statistics-with-r-part-i-quantitative-variables-ch6.html#numerical-representation-2"><i class="fa fa-check"></i><b>7.4.1</b> Numerical representation</a></li>
<li class="chapter" data-level="7.4.2" data-path="descriptive-statistics-with-r-part-i-quantitative-variables-ch6.html"><a href="descriptive-statistics-with-r-part-i-quantitative-variables-ch6.html#graphical-representation-2"><i class="fa fa-check"></i><b>7.4.2</b> Graphical representation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="descriptive-statistics-with-r-part-ii-categorical-variables-and-ggplot.html"><a href="descriptive-statistics-with-r-part-ii-categorical-variables-and-ggplot.html"><i class="fa fa-check"></i><b>8</b> Descriptive statistics with R: Part II-Categorical variables and ggplot</a><ul>
<li class="chapter" data-level="8.1" data-path="descriptive-statistics-with-r-part-ii-categorical-variables-and-ggplot.html"><a href="descriptive-statistics-with-r-part-ii-categorical-variables-and-ggplot.html#numerical-representation-3"><i class="fa fa-check"></i><b>8.1</b> Numerical representation</a></li>
<li class="chapter" data-level="8.2" data-path="descriptive-statistics-with-r-part-ii-categorical-variables-and-ggplot.html"><a href="descriptive-statistics-with-r-part-ii-categorical-variables-and-ggplot.html#graphical-representation-3"><i class="fa fa-check"></i><b>8.2</b> Graphical representation</a><ul>
<li class="chapter" data-level="8.2.1" data-path="descriptive-statistics-with-r-part-ii-categorical-variables-and-ggplot.html"><a href="descriptive-statistics-with-r-part-ii-categorical-variables-and-ggplot.html#barplots"><i class="fa fa-check"></i><b>8.2.1</b> (1) Barplots</a></li>
<li class="chapter" data-level="8.2.2" data-path="descriptive-statistics-with-r-part-ii-categorical-variables-and-ggplot.html"><a href="descriptive-statistics-with-r-part-ii-categorical-variables-and-ggplot.html#dotcharts"><i class="fa fa-check"></i><b>8.2.2</b> (2) Dotcharts</a></li>
<li class="chapter" data-level="8.2.3" data-path="descriptive-statistics-with-r-part-ii-categorical-variables-and-ggplot.html"><a href="descriptive-statistics-with-r-part-ii-categorical-variables-and-ggplot.html#piecharts"><i class="fa fa-check"></i><b>8.2.3</b> (3) Piecharts</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="descriptive-statistics-with-r-part-ii-categorical-variables-and-ggplot.html"><a href="descriptive-statistics-with-r-part-ii-categorical-variables-and-ggplot.html#ggplot2-function"><i class="fa fa-check"></i><b>8.3</b> ggplot2 function</a><ul>
<li class="chapter" data-level="8.3.1" data-path="descriptive-statistics-with-r-part-ii-categorical-variables-and-ggplot.html"><a href="descriptive-statistics-with-r-part-ii-categorical-variables-and-ggplot.html#a-simple-histogram-for-a-single-quantative-variable"><i class="fa fa-check"></i><b>8.3.1</b> (1)a simple histogram for a single quantative variable</a></li>
<li class="chapter" data-level="8.3.2" data-path="descriptive-statistics-with-r-part-ii-categorical-variables-and-ggplot.html"><a href="descriptive-statistics-with-r-part-ii-categorical-variables-and-ggplot.html#for-a-quantative-variable-by-groups"><i class="fa fa-check"></i><b>8.3.2</b> (2)for a quantative variable by groups</a></li>
<li class="chapter" data-level="8.3.3" data-path="descriptive-statistics-with-r-part-ii-categorical-variables-and-ggplot.html"><a href="descriptive-statistics-with-r-part-ii-categorical-variables-and-ggplot.html#for-two-quantitative-variables-1"><i class="fa fa-check"></i><b>8.3.3</b> (3) for two quantitative variables</a></li>
<li class="chapter" data-level="8.3.4" data-path="descriptive-statistics-with-r-part-ii-categorical-variables-and-ggplot.html"><a href="descriptive-statistics-with-r-part-ii-categorical-variables-and-ggplot.html#for-categorial-variable"><i class="fa fa-check"></i><b>8.3.4</b> (4) for categorial variable</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="basic-statistical-tests-with-r.html"><a href="basic-statistical-tests-with-r.html"><i class="fa fa-check"></i><b>9</b> Basic statistical tests with R</a><ul>
<li class="chapter" data-level="9.1" data-path="basic-statistical-tests-with-r.html"><a href="basic-statistical-tests-with-r.html#two-sample-tests"><i class="fa fa-check"></i><b>9.1</b> Two-sample tests</a><ul>
<li class="chapter" data-level="9.1.1" data-path="basic-statistical-tests-with-r.html"><a href="basic-statistical-tests-with-r.html#t-test"><i class="fa fa-check"></i><b>9.1.1</b> t-test</a></li>
<li class="chapter" data-level="9.1.2" data-path="basic-statistical-tests-with-r.html"><a href="basic-statistical-tests-with-r.html#nonparametric-tests"><i class="fa fa-check"></i><b>9.1.2</b> Nonparametric tests</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="basic-statistical-tests-with-r.html"><a href="basic-statistical-tests-with-r.html#analysis-of-variance"><i class="fa fa-check"></i><b>9.2</b> Analysis Of Variance</a><ul>
<li class="chapter" data-level="9.2.1" data-path="basic-statistical-tests-with-r.html"><a href="basic-statistical-tests-with-r.html#assumptions-assessment"><i class="fa fa-check"></i><b>9.2.1</b> Assumptions assessment</a></li>
<li class="chapter" data-level="9.2.2" data-path="basic-statistical-tests-with-r.html"><a href="basic-statistical-tests-with-r.html#parametric-test"><i class="fa fa-check"></i><b>9.2.2</b> Parametric test</a></li>
<li class="chapter" data-level="9.2.3" data-path="basic-statistical-tests-with-r.html"><a href="basic-statistical-tests-with-r.html#nonparametric-test"><i class="fa fa-check"></i><b>9.2.3</b> Nonparametric test</a></li>
<li class="chapter" data-level="9.2.4" data-path="basic-statistical-tests-with-r.html"><a href="basic-statistical-tests-with-r.html#multivariate-analysis-of-variance"><i class="fa fa-check"></i><b>9.2.4</b> Multivariate analysis of variance</a></li>
<li class="chapter" data-level="9.2.5" data-path="basic-statistical-tests-with-r.html"><a href="basic-statistical-tests-with-r.html#two-way-analysis-of-variance"><i class="fa fa-check"></i><b>9.2.5</b> Two-way analysis of variance</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="basic-statistical-tests-with-r.html"><a href="basic-statistical-tests-with-r.html#correlation"><i class="fa fa-check"></i><b>9.3</b> Correlation</a><ul>
<li class="chapter" data-level="9.3.1" data-path="basic-statistical-tests-with-r.html"><a href="basic-statistical-tests-with-r.html#spearmans-"><i class="fa fa-check"></i><b>9.3.1</b> Spearman’s ρ</a></li>
<li class="chapter" data-level="9.3.2" data-path="basic-statistical-tests-with-r.html"><a href="basic-statistical-tests-with-r.html#kendalls-"><i class="fa fa-check"></i><b>9.3.2</b> Kendall’s τ</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="basic-statistical-tests-with-r.html"><a href="basic-statistical-tests-with-r.html#tabular-data"><i class="fa fa-check"></i><b>9.4</b> Tabular data</a><ul>
<li class="chapter" data-level="9.4.1" data-path="basic-statistical-tests-with-r.html"><a href="basic-statistical-tests-with-r.html#single-proportion"><i class="fa fa-check"></i><b>9.4.1</b> Single proportion</a></li>
<li class="chapter" data-level="9.4.2" data-path="basic-statistical-tests-with-r.html"><a href="basic-statistical-tests-with-r.html#two-independent-proportions"><i class="fa fa-check"></i><b>9.4.2</b> Two independent proportions</a></li>
<li class="chapter" data-level="9.4.3" data-path="basic-statistical-tests-with-r.html"><a href="basic-statistical-tests-with-r.html#k-proportions"><i class="fa fa-check"></i><b>9.4.3</b> k proportions</a></li>
<li class="chapter" data-level="9.4.4" data-path="basic-statistical-tests-with-r.html"><a href="basic-statistical-tests-with-r.html#r-c-tables"><i class="fa fa-check"></i><b>9.4.4</b> r × c tables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="regressions-with-r-linear-regression.html"><a href="regressions-with-r-linear-regression.html"><i class="fa fa-check"></i><b>10</b> Regressions with R-Linear Regression</a><ul>
<li class="chapter" data-level="10.1" data-path="regressions-with-r-linear-regression.html"><a href="regressions-with-r-linear-regression.html#simple-linear-regression"><i class="fa fa-check"></i><b>10.1</b> Simple linear regression</a><ul>
<li class="chapter" data-level="10.1.1" data-path="regressions-with-r-linear-regression.html"><a href="regressions-with-r-linear-regression.html#function"><i class="fa fa-check"></i><b>10.1.1</b> Function</a></li>
<li class="chapter" data-level="10.1.2" data-path="regressions-with-r-linear-regression.html"><a href="regressions-with-r-linear-regression.html#output-explanation"><i class="fa fa-check"></i><b>10.1.2</b> Output explanation</a></li>
<li class="chapter" data-level="10.1.3" data-path="regressions-with-r-linear-regression.html"><a href="regressions-with-r-linear-regression.html#other-useful-functions-1"><i class="fa fa-check"></i><b>10.1.3</b> Other useful functions</a></li>
<li class="chapter" data-level="10.1.4" data-path="regressions-with-r-linear-regression.html"><a href="regressions-with-r-linear-regression.html#fitted-values-and-residuals"><i class="fa fa-check"></i><b>10.1.4</b> Fitted values and residuals</a></li>
<li class="chapter" data-level="10.1.5" data-path="regressions-with-r-linear-regression.html"><a href="regressions-with-r-linear-regression.html#prediction-and-confidence-intervals"><i class="fa fa-check"></i><b>10.1.5</b> Prediction and confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="regressions-with-r-linear-regression.html"><a href="regressions-with-r-linear-regression.html#multiple-linear-regression"><i class="fa fa-check"></i><b>10.2</b> Multiple linear regression</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="survival-analysis.html"><a href="survival-analysis.html"><i class="fa fa-check"></i><b>11</b> Survival analysis</a><ul>
<li class="chapter" data-level="11.1" data-path="survival-analysis.html"><a href="survival-analysis.html#create-the-response-variable"><i class="fa fa-check"></i><b>11.1</b> Create the response variable</a></li>
<li class="chapter" data-level="11.2" data-path="survival-analysis.html"><a href="survival-analysis.html#kaplan-meier-estimate"><i class="fa fa-check"></i><b>11.2</b> Kaplan-Meier estimate</a></li>
<li class="chapter" data-level="11.3" data-path="survival-analysis.html"><a href="survival-analysis.html#cumulative-hazard"><i class="fa fa-check"></i><b>11.3</b> Cumulative hazard</a></li>
<li class="chapter" data-level="11.4" data-path="survival-analysis.html"><a href="survival-analysis.html#the-log-rank-test"><i class="fa fa-check"></i><b>11.4</b> The log-rank test</a></li>
<li class="chapter" data-level="11.5" data-path="survival-analysis.html"><a href="survival-analysis.html#cox-proportional-hazards-model"><i class="fa fa-check"></i><b>11.5</b> Cox Proportional Hazards Model</a><ul>
<li class="chapter" data-level="11.5.1" data-path="survival-analysis.html"><a href="survival-analysis.html#regular-cox-proportional-hazards-model"><i class="fa fa-check"></i><b>11.5.1</b> Regular Cox proportional hazards model</a></li>
<li class="chapter" data-level="11.5.2" data-path="survival-analysis.html"><a href="survival-analysis.html#test-for-proportional-hazards"><i class="fa fa-check"></i><b>11.5.2</b> Test for proportional hazards</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bootstrap-analysis-of-clustered-data-and-non-linear-effects.html"><a href="bootstrap-analysis-of-clustered-data-and-non-linear-effects.html"><i class="fa fa-check"></i><b>12</b> Bootstrap, analysis of clustered data and non-linear effects</a><ul>
<li class="chapter" data-level="12.1" data-path="bootstrap-analysis-of-clustered-data-and-non-linear-effects.html"><a href="bootstrap-analysis-of-clustered-data-and-non-linear-effects.html#bootstrap"><i class="fa fa-check"></i><b>12.1</b> Bootstrap</a></li>
<li class="chapter" data-level="12.2" data-path="bootstrap-analysis-of-clustered-data-and-non-linear-effects.html"><a href="bootstrap-analysis-of-clustered-data-and-non-linear-effects.html#analysis-of-clustered-data"><i class="fa fa-check"></i><b>12.2</b> Analysis of clustered data</a><ul>
<li class="chapter" data-level="12.2.1" data-path="bootstrap-analysis-of-clustered-data-and-non-linear-effects.html"><a href="bootstrap-analysis-of-clustered-data-and-non-linear-effects.html#linear-mixed-effects-models"><i class="fa fa-check"></i><b>12.2.1</b> Linear Mixed Effects Models</a></li>
<li class="chapter" data-level="12.2.2" data-path="bootstrap-analysis-of-clustered-data-and-non-linear-effects.html"><a href="bootstrap-analysis-of-clustered-data-and-non-linear-effects.html#generalized-estimation-equations-gee-models"><i class="fa fa-check"></i><b>12.2.2</b> Generalized Estimation Equations (GEE) models</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="bootstrap-analysis-of-clustered-data-and-non-linear-effects.html"><a href="bootstrap-analysis-of-clustered-data-and-non-linear-effects.html#non-linear-effects"><i class="fa fa-check"></i><b>12.3</b> Non-linear effects</a></li>
<li class="chapter" data-level="12.4" data-path="bootstrap-analysis-of-clustered-data-and-non-linear-effects.html"><a href="bootstrap-analysis-of-clustered-data-and-non-linear-effects.html#epi-packages--epitab"><i class="fa fa-check"></i><b>12.4</b> Epi packages- Epitab()</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An introduction to R for McGill Epidemiology and Public Health students</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="descriptive-statistics-with-r-part-i-quantitative-variables-ch6" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Descriptive statistics with R: Part I-Quantitative variables {ch6}</h1>
<p>Before going into the actual statistical modelling and analysis of a data set, it is often useful to make some simple characterizations of the data.</p>
<p>The data set diabetes_1 will be used as the example, which contains a population of women who were at least 21 years old, of Pima Indian heritage and living near Phoenix, Arizona, was tested for diabetes according to World Health Organization criteria. There are four quantitative variables: glu, bp, bmi and age; one categorical variable: type.</p>
<p>glu: plasma glucose concentration in an oral glucose tolerance test bp:diastolic blood pressure (mm Hg) bmi:body mass index (weight in kg/(height in m)^2) age: age in years type:Yes or No, for diabetic according to WHO criteria.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#read in the dataset</span>
mydata&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;data/diabetes_1.csv&quot;</span>,<span class="dt">header=</span>T)
<span class="kw">dim</span>(mydata)</code></pre></div>
<pre><code>## [1] 332   5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(mydata)</code></pre></div>
<pre><code>##   glu bp  bmi age type
## 1 148 72 33.6  50  Yes
## 2  85 66 26.6  31   No
## 3  89 66 28.1  21   No
## 4  78 50 31.0  26  Yes
## 5 197 70 30.5  53  Yes
## 6 166 72 25.8  51  Yes</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#create another variable age_cat which is a categorical variable of age#</span>
mydata<span class="op">$</span>age_cat[mydata<span class="op">$</span>age<span class="op">&lt;=</span><span class="dv">30</span>]&lt;-<span class="dv">1</span>
mydata<span class="op">$</span>age_cat[mydata<span class="op">$</span>age<span class="op">&gt;</span><span class="dv">30</span> <span class="op">&amp;</span><span class="st"> </span>mydata<span class="op">$</span>age<span class="op">&lt;=</span><span class="dv">50</span>]&lt;-<span class="dv">2</span>
mydata<span class="op">$</span>age_cat[mydata<span class="op">$</span>age<span class="op">&gt;</span><span class="dv">50</span> ]&lt;-<span class="dv">3</span>
mydata<span class="op">$</span>age_cat=<span class="kw">factor</span>(mydata<span class="op">$</span>age_cat,<span class="dt">levels=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;&lt;=30&quot;</span>,<span class="st">&quot;30-50&quot;</span>,<span class="st">&quot;&gt;50&quot;</span>))
<span class="kw">write.csv</span>(mydata,<span class="dt">file=</span><span class="st">&quot;diabetes_new.csv&quot;</span>,<span class="dt">row.names=</span>F)<span class="co">#prevent rownames to be written.</span></code></pre></div>
<p>Now the dataset mydata contains four quantitative variables: glu, bp, bmi and age; two categorical variables: type and age_cat.</p>
<div id="for-the-whole-dataset" class="section level2">
<h2><span class="header-section-number">7.1</span> For the whole dataset</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># mean,median,25th and 75th quartiles,min,max</span>
<span class="kw">summary</span>(mydata)</code></pre></div>
<pre><code>##       glu              bp              bmi             age       
##  Min.   : 65.0   Min.   : 24.00   Min.   :19.40   Min.   :21.00  
##  1st Qu.: 96.0   1st Qu.: 64.00   1st Qu.:28.18   1st Qu.:23.00  
##  Median :112.0   Median : 72.00   Median :32.90   Median :27.00  
##  Mean   :119.3   Mean   : 71.65   Mean   :33.24   Mean   :31.32  
##  3rd Qu.:136.2   3rd Qu.: 80.00   3rd Qu.:37.20   3rd Qu.:37.00  
##  Max.   :197.0   Max.   :110.00   Max.   :67.10   Max.   :81.00  
##   type      age_cat   
##  No :223   &lt;=30 :205  
##  Yes:109   30-50:105  
##            &gt;50  : 22  
##                       
##                       
## </code></pre>
<p>That returns some basic calculations for each column. For continous variable, we’ll see the minimum and maximum values along with median, mean, 1st quartile and 3rd quartile. For categorical variable, we will see the counts in each category group.</p>
<p>There are also numerous R functions designed to provide a range of descriptive statistics. For example:</p>
<pre><code>install.packages(&quot;psych&quot;)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(psych)
<span class="kw">describe</span>(mydata)</code></pre></div>
<pre><code>##          vars   n   mean    sd median trimmed   mad  min   max range  skew
## glu         1 332 119.26 30.50  112.0  116.58 26.69 65.0 197.0 132.0  0.70
## bp          2 332  71.65 12.80   72.0   71.79 11.86 24.0 110.0  86.0 -0.08
## bmi         3 332  33.24  7.28   32.9   32.79  6.75 19.4  67.1  47.7  0.80
## age         4 332  31.32 10.64   27.0   29.65  7.41 21.0  81.0  60.0  1.38
## type*       5 332   1.33  0.47    1.0    1.29  0.00  1.0   2.0   1.0  0.73
## age_cat*    6 332   1.45  0.62    1.0    1.35  0.00  1.0   3.0   2.0  1.04
##          kurtosis   se
## glu         -0.31 1.67
## bp           0.81 0.70
## bmi          1.46 0.40
## age          1.76 0.58
## type*       -1.47 0.03
## age_cat*     0.02 0.03</code></pre>
<p>This returns several more statistics from the data including standard deviation, “mad” (mean absolute deviation), skew (measuring whether or not the data distribution is symmetrical) and kurtosis (whether the data have a sharp or flatter peak near its mean).</p>
<pre><code>install.packages(&quot;pastecs&quot;)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pastecs)</code></pre></div>
<pre><code>## Loading required package: boot</code></pre>
<pre><code>## 
## Attaching package: &#39;boot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     logit</code></pre>
<pre><code>## 
## Attaching package: &#39;pastecs&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     first, last</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stat.desc</span>(mydata) <span class="co">#Compute a table giving various descriptive statistics about the series </span></code></pre></div>
<pre><code>##                       glu           bp          bmi          age type
## nbr.val      3.320000e+02 3.320000e+02 3.320000e+02 3.320000e+02   NA
## nbr.null     0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00   NA
## nbr.na       0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00   NA
## min          6.500000e+01 2.400000e+01 1.940000e+01 2.100000e+01   NA
## max          1.970000e+02 1.100000e+02 6.710000e+01 8.100000e+01   NA
## range        1.320000e+02 8.600000e+01 4.770000e+01 6.000000e+01   NA
## sum          3.959400e+04 2.378900e+04 1.103560e+04 1.039700e+04   NA
## median       1.120000e+02 7.200000e+01 3.290000e+01 2.700000e+01   NA
## mean         1.192590e+02 7.165361e+01 3.323976e+01 3.131627e+01   NA
## SE.mean      1.673967e+00 7.024532e-01 3.997011e-01 5.837387e-01   NA
## CI.mean.0.95 3.292956e+00 1.381836e+00 7.862748e-01 1.148306e+00   NA
## var          9.303194e+02 1.638223e+02 5.304065e+01 1.131293e+02   NA
## std.dev      3.050114e+01 1.279931e+01 7.282901e+00 1.063622e+01   NA
## coef.var     2.557554e-01 1.786275e-01 2.191021e-01 3.396390e-01   NA
##              age_cat
## nbr.val           NA
## nbr.null          NA
## nbr.na            NA
## min               NA
## max               NA
## range             NA
## sum               NA
## median            NA
## mean              NA
## SE.mean           NA
## CI.mean.0.95      NA
## var               NA
## std.dev           NA
## coef.var          NA</code></pre>
</div>
<div id="for-a-single-quantitative-variable" class="section level2">
<h2><span class="header-section-number">7.2</span> For a single quantitative variable</h2>
<div id="numerical-representation" class="section level3">
<h3><span class="header-section-number">7.2.1</span> Numerical representation</h3>
<p>As we described in previous lectures, R provides a wide range of functions for obtaining summary statistics, i.e.,mean, sd, var, min, max, median, range, and quantile.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(mydata<span class="op">$</span>age)</code></pre></div>
<pre><code>## [1] 31.31627</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">median</span>(mydata<span class="op">$</span>age)</code></pre></div>
<pre><code>## [1] 27</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>(mydata<span class="op">$</span>age)</code></pre></div>
<pre><code>## [1] 10.63622</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">range</span>(mydata<span class="op">$</span>age)</code></pre></div>
<pre><code>## [1] 21 81</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">quantile</span>(mydata<span class="op">$</span>age)</code></pre></div>
<pre><code>##   0%  25%  50%  75% 100% 
##   21   23   27   37   81</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># min,25th quartile, median,75th quartile,max</span>
<span class="kw">fivenum</span>(mydata<span class="op">$</span>age)</code></pre></div>
<pre><code>## [1] 21 23 27 37 81</code></pre>
<p>We can apply trim parameter to exclude some values if they are outliers. When trim parameter is supplied, the values of the variable get sorted and then the required numbers of observations are dropped from calculating the mean.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(mydata<span class="op">$</span>age,<span class="dt">trim=</span><span class="fl">0.3</span>)<span class="co">#The age variable will first get sorted and 3 values from each end will be dropped from the calculations to find mean.</span></code></pre></div>
<pre><code>## [1] 27.83582</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#for the above functions, they only work for the vectors, so we have to select a specified column.</span></code></pre></div>
<p>To combine the results into one summary table:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sumtab&lt;-<span class="kw">rbind</span>(<span class="kw">mean</span>(mydata<span class="op">$</span>age),<span class="kw">median</span>(mydata<span class="op">$</span>age),<span class="kw">sd</span>(mydata<span class="op">$</span>age))
<span class="kw">rownames</span>(sumtab)&lt;-<span class="kw">c</span>(<span class="st">&quot;mean&quot;</span>,<span class="st">&quot;median&quot;</span>,<span class="st">&quot;sd&quot;</span>) 
sumtab</code></pre></div>
<pre><code>##            [,1]
## mean   31.31627
## median 27.00000
## sd     10.63622</code></pre>
</div>
<div id="graphical-representation" class="section level3">
<h3><span class="header-section-number">7.2.2</span> Graphical representation</h3>
<div id="histograms" class="section level4">
<h4><span class="header-section-number">7.2.2.1</span> (1) Histograms</h4>
<p>We can get a reasonable impression of the shape of a distribution by drawing a histogram, which, is a count of how many observations fall within specified divisions of the x-axis.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(mydata<span class="op">$</span>age, <span class="dt">col=</span><span class="st">&quot;skyblue4&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-147-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#The column height is the raw number in each interval so that we can see how many observations have gone into each column</span></code></pre></div>
<p>If we want to get the density plot, where the area of a column is proportional to the number, we can set freq=F. This is helpful if we want to compare with other populations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(mydata<span class="op">$</span>age, <span class="dt">freq=</span>F,<span class="dt">col=</span><span class="st">&quot;skyblue4&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-148-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#The y-axis is in density units , so that the total area of the histogram will be 1. </span></code></pre></div>
<p>If we want to obtain a count in age groups 20-30,30-40,40-50,50-60,60-70,70-81:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brk&lt;-<span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">81</span>)
<span class="kw">hist</span>(mydata<span class="op">$</span>age,<span class="dt">breaks=</span>brk,<span class="dt">freq=</span>F,<span class="dt">col=</span><span class="st">&quot;skyblue4&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-149-1.png" width="672" /></p>
<p>To improve it:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(mydata<span class="op">$</span>age,<span class="dt">breaks=</span>brk,<span class="dt">col=</span><span class="st">&quot;skyblue4&quot;</span>,<span class="dt">freq=</span>F,<span class="dt">xlab=</span><span class="st">&quot;Age&quot;</span>,<span class="dt">main=</span><span class="st">&quot;Age Distribution&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-150-1.png" width="672" /></p>
<p>Histograms can be a poor method for determining the shape of a distribution because it is so strongly affected by the number of bins used. We may want to add estimated smooth density curves to the plot using the density() function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(mydata<span class="op">$</span>age,<span class="dt">breaks=</span>brk,<span class="dt">col=</span><span class="st">&quot;skyblue4&quot;</span>,<span class="dt">freq=</span>F,<span class="dt">xlab=</span><span class="st">&quot;Age&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.065</span>),<span class="dt">main=</span><span class="st">&quot;Age Distribution&quot;</span>)
d &lt;-<span class="st"> </span><span class="kw">density</span>(mydata<span class="op">$</span>age)
<span class="kw">lines</span>(d,<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-151-1.png" width="672" /></p>
<p>We may want a filled density plot alone:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(d, <span class="dt">main=</span><span class="st">&quot;Density plot of age&quot;</span>)
<span class="kw">polygon</span>(d, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">border=</span><span class="st">&quot;blue&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-152-1.png" width="672" /></p>
<p>We may also want to compare the observed density with a theoretical density e.g. a normal distribution. We can simply add a corresponding density curve using the lines() and dnorm().</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(mydata<span class="op">$</span>age,<span class="dt">breaks=</span>brk,<span class="dt">col=</span><span class="st">&quot;skyblue4&quot;</span>,<span class="dt">freq=</span>F,<span class="dt">xlab=</span><span class="st">&quot;Age&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.065</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">100</span>),<span class="dt">main=</span><span class="st">&quot;Age Distribution&quot;</span>)
<span class="kw">lines</span>(d,<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>)
<span class="kw">lines</span>(<span class="kw">dnorm</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,<span class="kw">mean</span>(mydata<span class="op">$</span>age),<span class="dt">sd=</span><span class="kw">sd</span>(mydata<span class="op">$</span>age)),<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">3</span>)
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;estimated density&quot;</span>,<span class="st">&quot;expected density under Normal distribution&quot;</span>))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-153-1.png" width="672" /></p>
<p>We can improve the legend by changing some parameters:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(mydata<span class="op">$</span>age,<span class="dt">breaks=</span>brk,<span class="dt">col=</span><span class="st">&quot;skyblue4&quot;</span>,<span class="dt">freq=</span>F,<span class="dt">xlab=</span><span class="st">&quot;Age&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.065</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">100</span>),<span class="dt">main=</span><span class="st">&quot;Age Distribution&quot;</span>)
<span class="kw">lines</span>(d,<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>)
<span class="kw">lines</span>(<span class="kw">dnorm</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,<span class="kw">mean</span>(mydata<span class="op">$</span>age),<span class="dt">sd=</span><span class="kw">sd</span>(mydata<span class="op">$</span>age)),<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">3</span>)
<span class="kw">legend</span>(<span class="dv">60</span>,<span class="fl">0.04</span>,<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;estimated density&quot;</span>,<span class="st">&quot;expected density under </span><span class="ch">\n</span><span class="st"> Normal distribution&quot;</span>),<span class="dt">bty=</span><span class="st">&quot;n&quot;</span>)<span class="co">#\n force the text to be written in the next line</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-154-1.png" width="672" /></p>
<p>We may want to display a single value for each individual. In this case, we can use rug() function, which adds vertical bars showing the distribution of values of x along the x-axis of the current plot. It is particularly useful for showing the actual values along the side of a boxplot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(mydata<span class="op">$</span>age,<span class="dt">breaks=</span>brk,<span class="dt">col=</span><span class="st">&quot;skyblue4&quot;</span>,<span class="dt">freq=</span>F,<span class="dt">xlab=</span><span class="st">&quot;Age&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.065</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">100</span>),<span class="dt">main=</span><span class="st">&quot;Age Distribution&quot;</span>)
<span class="kw">rug</span>(mydata<span class="op">$</span>age,<span class="dt">col=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-155-1.png" width="672" /></p>
</div>
<div id="boxplot" class="section level4">
<h4><span class="header-section-number">7.2.2.2</span> (2) Boxplot</h4>
<p>The box plot of an observation variable is a graphical representation based on its quartiles, as well as its smallest and largest values. It attempts to provide a visual shape of the data distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(mydata<span class="op">$</span>age,<span class="dt">ylab=</span><span class="st">&quot;age&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-156-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#The box in the middle indicates “hinges” (nearly quartiles) and median. The lines show the largest or smallest observation that falls within a distance of 1.5 times the box size from the nearest hinge. If any observations fall farther away, the additional points are considered “extreme” values and are shown separately.</span>
<span class="kw">boxplot</span>(mydata<span class="op">$</span>age,<span class="dt">xlab=</span><span class="st">&quot;age&quot;</span>,<span class="dt">horizontal=</span>T)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-156-2.png" width="672" /></p>
<p>We can add means to the plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(mydata<span class="op">$</span>age,<span class="dt">ylab=</span><span class="st">&quot;age&quot;</span>)
<span class="kw">points</span>(<span class="dv">1</span>,<span class="kw">mean</span>(mydata<span class="op">$</span>age),<span class="dt">pch=</span><span class="st">&quot;x&quot;</span>,<span class="dt">cex=</span><span class="fl">1.6</span>, <span class="dt">col=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-157-1.png" width="672" /></p>
</div>
<div id="empirical-cumulative-distribution" class="section level4">
<h4><span class="header-section-number">7.2.2.3</span> (3) Empirical cumulative distribution</h4>
<p>The empirical cumulative distribution function (ECDF) is defined as the fraction of data smaller than or equal to x. That is, if x is the kth smallest observation, then the proportion k/n of the data is smaller than or equal to x .</p>
<p>The ECDF provides an alternative visualisation of distribution and we can see whether data is normally distributed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="kw">length</span>(mydata<span class="op">$</span>age)
<span class="kw">plot</span>(<span class="kw">sort</span>(mydata<span class="op">$</span>age),(<span class="dv">1</span><span class="op">:</span>n)<span class="op">/</span>n,<span class="dt">type=</span><span class="st">&quot;s&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">xlab=</span><span class="st">&quot;age&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;cumulative distribution function&quot;</span>,<span class="dt">main=</span><span class="st">&quot;Empirical cumulative distribution of age&quot;</span>)<span class="co">#The plotting parameter type=&quot;s&quot; gives a step function where (x, y) is the left end of the steps.</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-158-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#another way for plotting ECDF</span>
ecdf.age&lt;-<span class="kw">ecdf</span>(mydata<span class="op">$</span>age)
<span class="kw">plot</span>(ecdf.age,<span class="dt">xlab=</span><span class="st">&quot;age&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;cumulative distribution function&quot;</span>,<span class="dt">main=</span><span class="st">&quot;Empirical cumulative distribution of age&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-158-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#This is also more precise regarding the mathematical definition of the step function.</span></code></pre></div>
</div>
<div id="q-q-plots" class="section level4">
<h4><span class="header-section-number">7.2.2.4</span> (4) Q-Q plots</h4>
<p>T see whether data can be assumed normally distributed, Q-Q plot is another way except the ECDF. In Q-Q plot, we are plotting the kth smallest observation against the expected value of the kth smallest observation out of n in a standard normal distribution. The point is that in this way we would expect to obtain a straight line if data come from a normal distribution with any mean and standard deviation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qqnorm</span>(mydata<span class="op">$</span>age,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)
<span class="kw">qqline</span>(mydata<span class="op">$</span>age,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-159-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#the observed values are now drawn along the y-axis. </span></code></pre></div>
</div>
</div>
</div>
<div id="for-a-quantitative-variable-by-groups" class="section level2">
<h2><span class="header-section-number">7.3</span> For a quantitative variable by groups</h2>
<div id="numerical-representation-1" class="section level3">
<h3><span class="header-section-number">7.3.1</span> Numerical representation</h3>
<p>When dealing with grouped data, we will often want to have various summary statistics computed within groups; To this end, we can use tapply().</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>(mydata<span class="op">$</span>glu,mydata<span class="op">$</span>age_cat,mean)<span class="co">#The tapply call takes the glu variable, splits it according to age variable, and computes the mean for each group.</span></code></pre></div>
<pre><code>##     &lt;=30    30-50      &gt;50 
## 114.6878 122.9524 144.2273</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xbar &lt;-<span class="st"> </span><span class="kw">tapply</span>(mydata<span class="op">$</span>glu,mydata<span class="op">$</span>age_cat, mean)
s &lt;-<span class="st"> </span><span class="kw">tapply</span>(mydata<span class="op">$</span>glu,mydata<span class="op">$</span>age_cat, sd)
n &lt;-<span class="st"> </span><span class="kw">tapply</span>(mydata<span class="op">$</span>glu,mydata<span class="op">$</span>age_cat, length)
<span class="kw">cbind</span>(<span class="dt">mean=</span>xbar,<span class="dt">std.dev=</span>s,<span class="dt">n=</span>n)</code></pre></div>
<pre><code>##           mean  std.dev   n
## &lt;=30  114.6878 28.03342 205
## 30-50 122.9524 31.69245 105
## &gt;50   144.2273 33.61396  22</code></pre>
<p>Function aggregate() is very similar to tapply() except that aggregate() works on an entire data frame and presents its results as a data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#calculate the mean for the whole dataset mydata.</span>
<span class="kw">aggregate</span>(mydata,<span class="dt">by=</span><span class="kw">list</span>(mydata<span class="op">$</span>age_cat),mean)<span class="co">#Notice that the grouping argument in this case must be a list, even when it is one-dimensional, and that the names of the list elements get used as column names in the output. </span></code></pre></div>
<pre><code>## Warning in mean.default(X[[i]], ...): argument is not numeric or logical:
## returning NA

## Warning in mean.default(X[[i]], ...): argument is not numeric or logical:
## returning NA

## Warning in mean.default(X[[i]], ...): argument is not numeric or logical:
## returning NA

## Warning in mean.default(X[[i]], ...): argument is not numeric or logical:
## returning NA

## Warning in mean.default(X[[i]], ...): argument is not numeric or logical:
## returning NA

## Warning in mean.default(X[[i]], ...): argument is not numeric or logical:
## returning NA</code></pre>
<pre><code>##   Group.1      glu       bp      bmi      age type age_cat
## 1    &lt;=30 114.6878 68.81951 33.00537 24.43415   NA      NA
## 2   30-50 122.9524 75.34286 33.74667 39.17143   NA      NA
## 3     &gt;50 144.2273 80.45455 33.00455 57.95455   NA      NA</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Note that it will return NA if argument is not numeric or logical</span></code></pre></div>
<p>The function by() can also be used for grouped data.The by() function is similar to aggregate except that it only allows functions that are applicable to entire data frames.</p>
<pre><code>by(data, INDICES, FUN, ..., simplify = TRUE)#data is the data frame we wish to analyse, INDICES is the variable we wish to stratify on  and FUN is the R function we want to compute for each subgroup (e.g. summary)</code></pre>
<p>Example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">by</span>(mydata,mydata<span class="op">$</span>age_cat, summary)</code></pre></div>
<pre><code>## mydata$age_cat: &lt;=30
##       glu              bp              bmi             age       
##  Min.   : 68.0   Min.   : 24.00   Min.   :19.40   Min.   :21.00  
##  1st Qu.: 94.0   1st Qu.: 62.00   1st Qu.:27.60   1st Qu.:22.00  
##  Median :108.0   Median : 68.00   Median :32.50   Median :24.00  
##  Mean   :114.7   Mean   : 68.82   Mean   :33.01   Mean   :24.43  
##  3rd Qu.:128.0   3rd Qu.: 78.00   3rd Qu.:37.20   3rd Qu.:26.00  
##  Max.   :196.0   Max.   :110.00   Max.   :67.10   Max.   :30.00  
##   type      age_cat   
##  No :160   &lt;=30 :205  
##  Yes: 45   30-50:  0  
##            &gt;50  :  0  
##                       
##                       
##                       
## -------------------------------------------------------- 
## mydata$age_cat: 30-50
##       glu            bp              bmi             age         type   
##  Min.   : 65   Min.   : 30.00   Min.   :20.80   Min.   :31.00   No :53  
##  1st Qu.: 99   1st Qu.: 70.00   1st Qu.:29.60   1st Qu.:35.00   Yes:52  
##  Median :118   Median : 74.00   Median :33.30   Median :38.00           
##  Mean   :123   Mean   : 75.34   Mean   :33.75   Mean   :39.17           
##  3rd Qu.:148   3rd Qu.: 84.00   3rd Qu.:36.70   3rd Qu.:43.00           
##  Max.   :197   Max.   :106.00   Max.   :50.00   Max.   :50.00           
##   age_cat   
##  &lt;=30 :  0  
##  30-50:105  
##  &gt;50  :  0  
##             
##             
##             
## -------------------------------------------------------- 
## mydata$age_cat: &gt;50
##       glu              bp              bmi             age         type   
##  Min.   : 90.0   Min.   : 60.00   Min.   :19.60   Min.   :51.00   No :10  
##  1st Qu.:115.5   1st Qu.: 74.00   1st Qu.:28.20   1st Qu.:53.00   Yes:12  
##  Median :143.5   Median : 76.00   Median :33.10   Median :56.00           
##  Mean   :144.2   Mean   : 80.45   Mean   :33.00   Mean   :57.95           
##  3rd Qu.:172.5   3rd Qu.: 85.75   3rd Qu.:36.83   3rd Qu.:60.75           
##  Max.   :197.0   Max.   :110.00   Max.   :46.50   Max.   :81.00           
##   age_cat  
##  &lt;=30 : 0  
##  30-50: 0  
##  &gt;50  :22  
##            
##            
## </code></pre>
<p>The result of the call to by is actually a list of objects that has been wrapped as an object of class “by” and printed using a print method for that class. Therefore we can access the result for each subgroup using standard list indexing.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">result&lt;-<span class="kw">by</span>(mydata,mydata<span class="op">$</span>age_cat, summary)
result[<span class="dv">1</span>]</code></pre></div>
<pre><code>## $`&lt;=30`
##       glu              bp              bmi             age       
##  Min.   : 68.0   Min.   : 24.00   Min.   :19.40   Min.   :21.00  
##  1st Qu.: 94.0   1st Qu.: 62.00   1st Qu.:27.60   1st Qu.:22.00  
##  Median :108.0   Median : 68.00   Median :32.50   Median :24.00  
##  Mean   :114.7   Mean   : 68.82   Mean   :33.01   Mean   :24.43  
##  3rd Qu.:128.0   3rd Qu.: 78.00   3rd Qu.:37.20   3rd Qu.:26.00  
##  Max.   :196.0   Max.   :110.00   Max.   :67.10   Max.   :30.00  
##   type      age_cat   
##  No :160   &lt;=30 :205  
##  Yes: 45   30-50:  0  
##            &gt;50  :  0  
##                       
##                       
## </code></pre>
<p>Note that the default R functions mean(), sd(), median() and quantile() are not applicable to entire data frames (only to individual vectors or variables). Therefore they cannot be combined with the by() function.</p>
<p>We can also choose to use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(mydata[mydata<span class="op">$</span>age_cat<span class="op">==</span><span class="kw">levels</span>(mydata<span class="op">$</span>age_cat)[<span class="dv">1</span>],])</code></pre></div>
<pre><code>##       glu              bp              bmi             age       
##  Min.   : 68.0   Min.   : 24.00   Min.   :19.40   Min.   :21.00  
##  1st Qu.: 94.0   1st Qu.: 62.00   1st Qu.:27.60   1st Qu.:22.00  
##  Median :108.0   Median : 68.00   Median :32.50   Median :24.00  
##  Mean   :114.7   Mean   : 68.82   Mean   :33.01   Mean   :24.43  
##  3rd Qu.:128.0   3rd Qu.: 78.00   3rd Qu.:37.20   3rd Qu.:26.00  
##  Max.   :196.0   Max.   :110.00   Max.   :67.10   Max.   :30.00  
##   type      age_cat   
##  No :160   &lt;=30 :205  
##  Yes: 45   30-50:  0  
##            &gt;50  :  0  
##                       
##                       
## </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(mydata[mydata<span class="op">$</span>age_cat<span class="op">==</span><span class="kw">levels</span>(mydata<span class="op">$</span>age_cat)[<span class="dv">2</span>],])</code></pre></div>
<pre><code>##       glu            bp              bmi             age         type   
##  Min.   : 65   Min.   : 30.00   Min.   :20.80   Min.   :31.00   No :53  
##  1st Qu.: 99   1st Qu.: 70.00   1st Qu.:29.60   1st Qu.:35.00   Yes:52  
##  Median :118   Median : 74.00   Median :33.30   Median :38.00           
##  Mean   :123   Mean   : 75.34   Mean   :33.75   Mean   :39.17           
##  3rd Qu.:148   3rd Qu.: 84.00   3rd Qu.:36.70   3rd Qu.:43.00           
##  Max.   :197   Max.   :106.00   Max.   :50.00   Max.   :50.00           
##   age_cat   
##  &lt;=30 :  0  
##  30-50:105  
##  &gt;50  :  0  
##             
##             
## </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(mydata[mydata<span class="op">$</span>age_cat<span class="op">==</span><span class="kw">levels</span>(mydata<span class="op">$</span>age_cat)[<span class="dv">3</span>],])</code></pre></div>
<pre><code>##       glu              bp              bmi             age         type   
##  Min.   : 90.0   Min.   : 60.00   Min.   :19.60   Min.   :51.00   No :10  
##  1st Qu.:115.5   1st Qu.: 74.00   1st Qu.:28.20   1st Qu.:53.00   Yes:12  
##  Median :143.5   Median : 76.00   Median :33.10   Median :56.00           
##  Mean   :144.2   Mean   : 80.45   Mean   :33.00   Mean   :57.95           
##  3rd Qu.:172.5   3rd Qu.: 85.75   3rd Qu.:36.83   3rd Qu.:60.75           
##  Max.   :197.0   Max.   :110.00   Max.   :46.50   Max.   :81.00           
##   age_cat  
##  &lt;=30 : 0  
##  30-50: 0  
##  &gt;50  :22  
##            
##            
## </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#or</span>
<span class="kw">describeBy</span>(mydata, mydata<span class="op">$</span>age_cat)</code></pre></div>
<pre><code>## 
##  Descriptive statistics by group 
## group: &lt;=30
##          vars   n   mean    sd median trimmed   mad  min   max range  skew
## glu         1 205 114.69 28.03  108.0  111.68 25.20 68.0 196.0 128.0  0.88
## bp          2 205  68.82 12.35   68.0   68.88 11.86 24.0 110.0  86.0 -0.06
## bmi         3 205  33.01  7.79   32.5   32.48  7.26 19.4  67.1  47.7  0.93
## age         4 205  24.43  2.65   24.0   24.25  2.97 21.0  30.0   9.0  0.46
## type*       5 205   1.22  0.41    1.0    1.15  0.00  1.0   2.0   1.0  1.35
## age_cat*    6 205   1.00  0.00    1.0    1.00  0.00  1.0   1.0   0.0   NaN
##          kurtosis   se
## glu          0.18 1.96
## bp           0.68 0.86
## bmi          1.80 0.54
## age         -0.89 0.19
## type*       -0.19 0.03
## age_cat*      NaN 0.00
## -------------------------------------------------------- 
## group: 30-50
##          vars   n   mean    sd median trimmed   mad  min max range  skew
## glu         1 105 122.95 31.69  118.0  121.20 31.13 65.0 197 132.0  0.48
## bp          2 105  75.34 12.21   74.0   75.68  8.90 30.0 106  76.0 -0.37
## bmi         3 105  33.75  6.28   33.3   33.38  5.49 20.8  50  29.2  0.54
## age         4 105  39.17  5.45   38.0   38.96  5.93 31.0  50  19.0  0.26
## type*       5 105   1.50  0.50    1.0    1.49  0.00  1.0   2   1.0  0.02
## age_cat*    6 105   2.00  0.00    2.0    2.00  0.00  2.0   2   0.0   NaN
##          kurtosis   se
## glu         -0.67 3.09
## bp           1.32 1.19
## bmi         -0.16 0.61
## age         -1.03 0.53
## type*       -2.02 0.05
## age_cat*      NaN 0.00
## -------------------------------------------------------- 
## group: &gt;50
##          vars  n   mean    sd median trimmed   mad  min   max range  skew
## glu         1 22 144.23 33.61  143.5  144.22 45.96 90.0 197.0 107.0 -0.03
## bp          2 22  80.45 11.58   76.0   79.00  7.41 60.0 110.0  50.0  1.05
## bmi         3 22  33.00  7.00   33.1   32.86  6.45 19.6  46.5  26.9  0.17
## age         4 22  57.95  7.32   56.0   56.78  5.93 51.0  81.0  30.0  1.46
## type*       5 22   1.55  0.51    2.0    1.56  0.00  1.0   2.0   1.0 -0.17
## age_cat*    6 22   3.00  0.00    3.0    3.00  0.00  3.0   3.0   0.0   NaN
##          kurtosis   se
## glu         -1.33 7.17
## bp           0.94 2.47
## bmi         -0.69 1.49
## age          2.06 1.56
## type*       -2.06 0.11
## age_cat*      NaN 0.00</code></pre>
</div>
<div id="graphical-representation-1" class="section level3">
<h3><span class="header-section-number">7.3.2</span> Graphical representation</h3>
<p>In dealing with grouped data, the purpose is not only to create plots for each group but also to compare the plots between groups.</p>
<div id="histograms-1" class="section level4">
<h4><span class="header-section-number">7.3.2.1</span> (1) Histograms</h4>
<p>We have already mentioned earlier in this lecture how to obtain a histogram by typing hist(x), where x is the variable containing the data. And we have also seen in previous lecture how to use par() to combine two plots in one image.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opar&lt;-<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))
<span class="kw">hist</span>(mydata<span class="op">$</span>glu[mydata<span class="op">$</span>age_cat<span class="op">==</span><span class="kw">levels</span>(mydata<span class="op">$</span>age_cat)[<span class="dv">1</span>]],<span class="dt">breaks=</span><span class="dv">10</span>,<span class="dt">col=</span><span class="st">&quot;violet&quot;</span>,<span class="dt">freq=</span>F)
<span class="kw">hist</span>(mydata<span class="op">$</span>glu[mydata<span class="op">$</span>age_cat<span class="op">==</span><span class="kw">levels</span>(mydata<span class="op">$</span>age_cat)[<span class="dv">2</span>]],<span class="dt">breaks=</span><span class="dv">10</span>,<span class="dt">col=</span><span class="st">&quot;tan1&quot;</span>,<span class="dt">freq=</span>F)
<span class="kw">hist</span>(mydata<span class="op">$</span>glu[mydata<span class="op">$</span>age_cat<span class="op">==</span><span class="kw">levels</span>(mydata<span class="op">$</span>age_cat)[<span class="dv">3</span>]],<span class="dt">breaks=</span><span class="dv">10</span>,<span class="dt">col=</span><span class="st">&quot;skyblue&quot;</span>,<span class="dt">freq=</span>F)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-165-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(opar)</code></pre></div>
<p>We can also compare groups via density plot:</p>
<pre><code>install.packages(&quot;sm&quot;)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(sm)</code></pre></div>
<pre><code>## Package &#39;sm&#39;, version 2.2-5.4: type help(sm) for summary information</code></pre>
<pre><code>## 
## Attaching package: &#39;sm&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     dogs</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sm.density.compare</span>(mydata<span class="op">$</span>glu, mydata<span class="op">$</span>age_cat, <span class="dt">xlab=</span><span class="st">&quot;Glucose level&quot;</span>,<span class="dt">col=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">lwd=</span><span class="dv">2</span>)
<span class="kw">title</span>(<span class="dt">main=</span><span class="st">&quot;Glucose distribution by age&quot;</span>)
<span class="kw">legend</span>(<span class="dv">175</span>,<span class="fl">0.014</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;age&lt;=30&quot;</span>,<span class="st">&quot;30&lt;age&lt;=50&quot;</span>,<span class="st">&quot;age&gt;50&quot;</span>),<span class="dt">bty=</span><span class="st">&quot;n&quot;</span>,<span class="dt">col=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-166-1.png" width="672" /> ####(2) Boxplot</p>
<p>Boxplot can be used by y~group where a separate boxplot for numeric variable y is generated for each value of group.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Draw the boxplot, with the number of individuals per group</span>
<span class="kw">boxplot</span>(mydata<span class="op">$</span>glu <span class="op">~</span><span class="st"> </span>mydata<span class="op">$</span>age_cat , <span class="dt">col=</span><span class="kw">rgb</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span>),<span class="dt">main=</span><span class="st">&quot;glucose distribution by age&quot;</span>)
<span class="co">#add means to the plot</span>
<span class="kw">points</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="kw">tapply</span>(mydata<span class="op">$</span>glu,mydata<span class="op">$</span>age_cat,mean),<span class="dt">pch=</span><span class="st">&quot;x&quot;</span>,<span class="dt">cex=</span><span class="fl">1.6</span>, <span class="dt">col=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-167-1.png" width="672" /></p>
<p>We can also plot against two crossed factors:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(mydata<span class="op">$</span>glu<span class="op">~</span>mydata<span class="op">$</span>type<span class="op">*</span>mydata<span class="op">$</span>age_cat, <span class="dt">notch=</span>F, 
  <span class="dt">col=</span>(<span class="kw">c</span>(<span class="st">&quot;gold&quot;</span>,<span class="st">&quot;tan&quot;</span>)),
  <span class="dt">main=</span><span class="st">&quot;glucose level in different age and type groups&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-168-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#we can compare medians using the notch=T statement in the boxplot() function.</span></code></pre></div>
</div>
<div id="violin-plots" class="section level4">
<h4><span class="header-section-number">7.3.2.2</span> (3) Violin Plots</h4>
<p>A violin plot is a combination of a boxplot and a kernel density plot.</p>
<pre><code>install.packages(&quot;vioplot&quot;)
</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(vioplot)
x1 &lt;-<span class="st"> </span>mydata<span class="op">$</span>glu[mydata<span class="op">$</span>age_cat<span class="op">==</span><span class="kw">levels</span>(mydata<span class="op">$</span>age_cat)[<span class="dv">1</span>]]
x2 &lt;-<span class="st"> </span>mydata<span class="op">$</span>glu[mydata<span class="op">$</span>age_cat<span class="op">==</span><span class="kw">levels</span>(mydata<span class="op">$</span>age_cat)[<span class="dv">2</span>]]
x3 &lt;-<span class="st"> </span>mydata<span class="op">$</span>glu[mydata<span class="op">$</span>age_cat<span class="op">==</span><span class="kw">levels</span>(mydata<span class="op">$</span>age_cat)[<span class="dv">3</span>]]
<span class="kw">vioplot</span>(x1, x2, x3, <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;age&lt;=30&quot;</span>, <span class="st">&quot;30&lt;age&lt;=50&quot;</span>, <span class="st">&quot;age&gt;50&quot;</span>), 
   <span class="dt">col=</span><span class="st">&quot;gold&quot;</span>)
<span class="kw">title</span>(<span class="st">&quot;Violin Plots of glucose level&quot;</span>)
<span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;glucose level&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-169-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="for-two-quantitative-variables" class="section level2">
<h2><span class="header-section-number">7.4</span> For two quantitative variables</h2>
<div id="numerical-representation-2" class="section level3">
<h3><span class="header-section-number">7.4.1</span> Numerical representation</h3>
<p>For two quantitative variables, we may want to know the correlation between the two variables.We can use the cor( ) function to produce correlations and the cov( ) function to produces covariances.For cor() and cov() functions, x must be numeric.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Correlations/covariances among numeric variables in  mydata. Use listwise deletion of missing data if necessary. </span>
<span class="kw">cor</span>(<span class="kw">subset</span>(mydata,<span class="dt">select=</span><span class="op">-</span><span class="kw">c</span>(age_cat,type)), <span class="dt">use=</span><span class="st">&quot;complete.obs&quot;</span>, <span class="dt">method=</span><span class="st">&quot;kendall&quot;</span>) </code></pre></div>
<pre><code>##           glu        bp        bmi        age
## glu 1.0000000 0.1491696 0.16899031 0.17206039
## bp  0.1491696 1.0000000 0.23704385 0.23604908
## bmi 0.1689903 0.2370438 1.00000000 0.09078753
## age 0.1720604 0.2360491 0.09078753 1.00000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cov</span>(<span class="kw">subset</span>(mydata,<span class="dt">select=</span><span class="op">-</span><span class="kw">c</span>(age_cat,type)), <span class="dt">use=</span><span class="st">&quot;complete.obs&quot;</span>)</code></pre></div>
<pre><code>##           glu        bp      bmi       age
## glu 930.31940  76.00238 60.89964  76.09608
## bp   76.00238 163.82225 31.52499  44.22771
## bmi  60.89964  31.52499 53.04065   3.66624
## age  76.09608  44.22771  3.66624 113.12928</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#generate correlations between the columns of X and the columns of Y</span>
x &lt;-<span class="st"> </span>mydata[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]
y &lt;-<span class="st"> </span>mydata[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>]
<span class="kw">cor</span>(x, y)</code></pre></div>
<pre><code>##           bmi       age
## glu 0.2741538 0.2345626
## bp  0.3381926 0.3248781</code></pre>
</div>
<div id="graphical-representation-2" class="section level3">
<h3><span class="header-section-number">7.4.2</span> Graphical representation</h3>
<p>A scatter plot pairs up values of two quantitative variables in a data set and display them as geometric points inside a Cartesian diagram. One variable is chosen in the horizontal axis and another in the vertical axis.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#a simple scatter plot</span>
<span class="kw">attach</span>(mydata)<span class="co">#the R knows where to find the following variables#</span></code></pre></div>
<pre><code>## The following object is masked _by_ .GlobalEnv:
## 
##     age</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(bmi, glu, <span class="dt">main=</span><span class="st">&quot;Scatterplot Example&quot;</span>, 
    <span class="dt">xlab=</span><span class="st">&quot;BMI &quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;glucose level &quot;</span>, <span class="dt">pch=</span><span class="dv">19</span>)
<span class="co"># Add fit lines</span>
<span class="kw">abline</span>(<span class="kw">lm</span>(glu<span class="op">~</span>bmi), <span class="dt">col=</span><span class="st">&quot;red&quot;</span>) <span class="co"># regression line (y~x) </span>
<span class="kw">lines</span>(<span class="kw">lowess</span>(bmi,glu), <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>) <span class="co"># lowess line (x,y)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-171-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">detach</span>(mydata)</code></pre></div>
<p>The scatterplot( ) function in the car package offers many enhanced features.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Enhanced Scatterplot </span>
<span class="co"># by age category</span>
<span class="kw">library</span>(car) <span class="co">#scatterplot() is built in the car()package</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;car&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     logit</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     logit</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     recode</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">scatterplot</span>(glu <span class="op">~</span><span class="st"> </span>bmi <span class="op">|</span><span class="st"> </span>type, <span class="dt">data=</span>mydata, 
    <span class="dt">xlab=</span><span class="st">&quot;BMI&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;glucose level&quot;</span>, 
   <span class="dt">main=</span><span class="st">&quot;Enhanced Scatter Plot&quot;</span>, 
   <span class="dt">labels=</span><span class="kw">row.names</span>(mydata),<span class="dt">smoother=</span>F,<span class="dt">reg.line=</span>F,<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;green&quot;</span>,<span class="st">&quot;violet&quot;</span>),<span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">19</span>))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-172-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#If we want to draw a regression line on the plot</span>
<span class="kw">scatterplot</span>(glu <span class="op">~</span><span class="st"> </span>bmi <span class="op">|</span><span class="st"> </span>type, <span class="dt">data=</span>mydata, 
    <span class="dt">xlab=</span><span class="st">&quot;BMI&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;glucose level&quot;</span>, 
   <span class="dt">main=</span><span class="st">&quot;Enhanced Scatter Plot&quot;</span>, 
   <span class="dt">labels=</span><span class="kw">row.names</span>(mydata),<span class="dt">smoother=</span>F,<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;green&quot;</span>,<span class="st">&quot;violet&quot;</span>),<span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">19</span>))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-172-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#If we want to add a nonparametric-regression smooth by loessLine</span>
<span class="kw">scatterplot</span>(glu <span class="op">~</span><span class="st"> </span>bmi <span class="op">|</span><span class="st"> </span>type, <span class="dt">data=</span>mydata, 
    <span class="dt">xlab=</span><span class="st">&quot;BMI&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;glucose level&quot;</span>, 
   <span class="dt">main=</span><span class="st">&quot;Enhanced Scatter Plot&quot;</span>, 
   <span class="dt">labels=</span><span class="kw">row.names</span>(mydata),<span class="dt">reg.line=</span>F,<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;green&quot;</span>,<span class="st">&quot;violet&quot;</span>),<span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">19</span>))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-172-3.png" width="672" /></p>
<p>When we have more than two variables and we want to find the correlation between one variable versus the remaining ones we use scatterplot matrix. We use pairs() function to create matrices of scatterplots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#If we want to a scatterplot matrix</span>
<span class="kw">pairs</span>(<span class="op">~</span>glu<span class="op">+</span>bp<span class="op">+</span>bmi<span class="op">+</span>age,<span class="dt">data=</span>mydata, 
   <span class="dt">main=</span><span class="st">&quot;Scatterplot Matrix&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-173-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="base-graphics-with-r-ch5.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="descriptive-statistics-with-r-part-ii-categorical-variables-and-ggplot.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/06-descriptiove-stats.Rmd",
"text": "Edit"
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
