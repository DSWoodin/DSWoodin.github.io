---
layout: post
title: Creating Global Conditions in System Center Configuration Manager for Office
  365 deployments
date: '2018-07-03T02:15:00.000-07:00'
author: syswow64
tags:
- SCCM
- Global Conditions
- powershell
- Office365
modified_time: '2020-01-17T04:20:26.669-08:00'
thumbnail: https://4.bp.blogspot.com/-eLnVwhO_X-k/Wzs2CeZl0NI/AAAAAAAABaI/RSGsJFfoeeoKZStVis1dNHvV23evSTLwwCLcBGAs/s72-c/Office365DeploymentTypes.png
blogger_id: tag:blogger.com,1999:blog-4452544758446808584.post-5233016969171829183
blogger_orig_url: https://www.syswow64.co.uk/2018/07/creating-global-conditions-in-system.html
---

<h2><span style="font-family: inherit;">Creating Global Conditions in System Center configuration Manager for Office 365 deployments</span></h2><span style="font-family: inherit;">Firstly I would recommend reading the Microsoft docs article below.</span><br /><a href="https://docs.microsoft.com/en-us/sccm/apps/deploy-use/create-global-conditions"><span style="font-family: inherit;">https://docs.microsoft.com/en-us/sccm/apps/deploy-use/create-global-conditions</span></a><br /><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><span class="" style="background-color: white; font-size: 16px; font-weight: 600;">Software Library</span><span style="background-color: white; font-size: 16px;">&nbsp;&gt;&nbsp;</span><span style="background-color: white; font-size: 16px; font-weight: 600;">Application Management</span><span style="background-color: white; font-size: 16px;">&nbsp;&gt;&nbsp;</span><span style="background-color: white; font-size: 16px; font-weight: 600;">Global Conditions</span><span style="background-color: white; font-size: 16px;">.</span></span><br /><span style="font-family: inherit;"><span style="background-color: white; font-size: 16px;"><br /></span><span style="background-color: white; font-size: 16px;"><b>Scenario:</b> I have an AD group "</span><span style="font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;">SD-LSG-Comp-Microsoft Project ClickToRun"&nbsp;</span><span style="background-color: white; font-size: 16px;">with computer objects that should install Office 365 -&nbsp;</span><span style="font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;">ProjectProXVolume edition. I wanted to create one application with multiple deployment types depending on their AD membership.</span></span><br /><span style="font-family: inherit;"><span style="font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;"><br /></span><span style="font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;">For example if the computer is only a members of the&nbsp;</span><span style="background-color: white; font-size: 16px;">"</span><span style="font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;">SD-LSG-Comp-Microsoft Project ClickToRun" AD group then the deployment should only run the deployment&nbsp;Type "</span><span style="font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;"><b>Office 365 Default Deployment Type-Install_InstallProject.cmd</b></span><span style="font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;">".&nbsp;&nbsp;</span></span><br /><span style="font-family: inherit;"><span style="font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;"><br /></span><span style="font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;">This deplyoment Type calls the Office 365 setup.exe with a configuration xml detailing the&nbsp;</span><b>&lt;Product ID="ProjectProXVolume"&gt;.</b></span><br /><span style="font-family: inherit;"><b><br /></b><b>(For a detailed understanding of how to package Office 365 see </b><a href="http://www.systemcenterblog.co.uk/2016/06/office-365-management-with-system.html" style="font-weight: bold;" target="_blank">here</a><b>. This blog will be updated to reflect the latest setup.exe and the switch &lt;RemoveMSI All="True" /&gt;)</b></span><br /><span style="font-family: inherit;"><span style="font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;"><br /></span>&lt;Configuration&gt;</span><br /><span style="font-family: inherit;">&lt;Add OfficeClientEdition="32" Channel="Monthly" OfficeMgmtCOM="True" AllowCdnFallback="True"&gt;</span><br /><b><span style="font-family: inherit;">&lt;Product ID="ProjectProXVolume"&gt;</span></b><br /><span style="font-family: inherit;">&lt;Language ID="en-us" /&gt;</span><br /><span style="font-family: inherit;">&lt;/Product&gt;</span><br /><span style="font-family: inherit;">&lt;/Add&gt;</span><br /><span style="font-family: inherit;">&lt;Updates Enabled="TRUE" /&gt;</span><br /><span style="font-family: inherit;">&lt;Display Level="none" AcceptEULA="TRUE" /&gt;</span><br /><span style="font-family: inherit;">&lt;Logging Path="%Windir%\Temp\" /&gt;</span><br /><span style="font-family: inherit;">&lt;Property Name="AUTOACTIVATE" Value="1" /&gt;</span><br /><span style="font-family: inherit;">&lt;/Configuration&gt;</span><br /><div><span style="font-family: inherit;"><br /></span></div><div><span style="font-family: inherit;">For the deployment to choose&nbsp;<span style="font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;">&nbsp;"</span><span style="font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;"><b>Office 365 Default Deployment Type-Install_InstallProject.cmd</b></span><span style="font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;">" we need to create a global condition that will issue a $True value if the computer is a member of the AD group "</span><span style="font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;">SD-LSG-Comp-Microsoft Project ClickToRun".</span></span></div><div><span style="font-family: inherit;"><span style="font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;"><br /></span></span><br /><div class="separator" style="clear: both;"><a href="https://4.bp.blogspot.com/-eLnVwhO_X-k/Wzs2CeZl0NI/AAAAAAAABaI/RSGsJFfoeeoKZStVis1dNHvV23evSTLwwCLcBGAs/s1600/Office365DeploymentTypes.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><span style="font-family: inherit;"><img border="0" data-original-height="416" data-original-width="1156" height="230" src="https://4.bp.blogspot.com/-eLnVwhO_X-k/Wzs2CeZl0NI/AAAAAAAABaI/RSGsJFfoeeoKZStVis1dNHvV23evSTLwwCLcBGAs/s640/Office365DeploymentTypes.png" width="640" /></span></a></div><span style="font-family: inherit;"><span style="font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;"><br /></span><span style="background-color: white; font-size: 16px;">The global condition created below, will run a Powershell script on the local computer listing all the groups the computer is a member of and if one of the groups found matches the AD group "</span><span style="font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;">SD-LSG-Comp-Microsoft Project ClickToRun<span style="background-color: white;">" issue a $true value and stop the script.&nbsp;</span></span></span><br /><span style="font-family: inherit;"><span style="background-color: white; font-size: 16px;"><br /></span></span><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-owxM9pE9GI4/Wzs0x3ODRWI/AAAAAAAABZ8/T0hDZFRw7HASUHshWB0ntT3F3ScIFy7UQCLcBGAs/s1600/GlobalConditions.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><span style="font-family: inherit;"><img border="0" data-original-height="794" data-original-width="1355" height="375" src="https://3.bp.blogspot.com/-owxM9pE9GI4/Wzs0x3ODRWI/AAAAAAAABZ8/T0hDZFRw7HASUHshWB0ntT3F3ScIFy7UQCLcBGAs/s640/GlobalConditions.png" width="640" /></span></a></div><span style="font-family: inherit;"><span style="background-color: white; font-size: 16px;"><br /></span></span><br /><span style="font-family: inherit;">#Get groups of local computer</span><br /><span style="font-family: inherit;">$Group = "AD Group Name"</span><br /><span style="font-family: inherit;">$ComputerMembership = ([adsisearcher]"(&amp;(objectCategory=computer)(cn=$env:COMPUTERNAME))").FindOne().Properties.memberof -replace '^CN=([^,]+).+$','$1' | % {If ($_ -ieq $Group) {$true;break;} }</span><br /><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">For the deployment to be linked to the AD group&nbsp; the deployment type&nbsp;<span style="font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;">"</span><span style="font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;"><b>Office 365 Default Deployment Type-Install_InstallProject.cmd</b></span><span style="font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;">" must have a "Requirement type" set.</span></span><br /><span style="font-family: inherit;"><span style="font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;"><br /></span><span style="font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;">We now simply set a the global condition created to equal True.&nbsp;</span></span><br /><span style="font-family: inherit;"><br /></span><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-xI7jl8eK8V0/Wzs7JVngHlI/AAAAAAAABaU/8886t5MqkfUP54DMm7NeIVa3taa9MqSmACLcBGAs/s1600/GlobalConditions2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><span style="font-family: inherit;"><img border="0" data-original-height="798" data-original-width="1460" height="348" src="https://3.bp.blogspot.com/-xI7jl8eK8V0/Wzs7JVngHlI/AAAAAAAABaU/8886t5MqkfUP54DMm7NeIVa3taa9MqSmACLcBGAs/s640/GlobalConditions2.png" width="640" /></span></a></div><span style="font-family: inherit;"><br /></span><br /><div><span style="font-family: inherit;">In my screen shot i have multiple deployment types for several scenarios i.e. Visio and Project, Visio, Project, Office365, Office 365 during a Task Sequence.</span><br /><span style="font-family: inherit;"><br /></span><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-3OU4aR66PZM/Wzs-XLHuAlI/AAAAAAAABa0/OBfi9EYRMNU3_TJSXscvowzddeNcWsougCLcBGAs/s1600/Office365DeploymentTypes2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><span style="font-family: inherit;"><img border="0" data-original-height="293" data-original-width="641" height="292" src="https://1.bp.blogspot.com/-3OU4aR66PZM/Wzs-XLHuAlI/AAAAAAAABa0/OBfi9EYRMNU3_TJSXscvowzddeNcWsougCLcBGAs/s640/Office365DeploymentTypes2.png" width="640" /></span></a></div><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">See Global Condition details below.</span><br /><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">&nbsp;<b>#Get groups of local computer</b></span><br /><span style="font-family: inherit;">$Group = "AD Group Name" <i>#The AD group name to be filtered.</i></span><br /><span style="font-family: inherit;">$ComputerMembership = ([adsisearcher]"(&amp;(objectCategory=computer)(cn=$env:COMPUTERNAME))").FindOne().Properties.memberof -replace '^CN=([^,]+).+$','$1' | % {If ($_ -ieq $Group) {$true;break;} }</span><br /><span style="font-family: inherit;"><br /></span><a href="https://3.bp.blogspot.com/-xTJqkIzjv-o/Wzs91TwnHgI/AAAAAAAABao/U3_weHKjSXk3WENhbsHhPdQENGGCmn9WwCLcBGAs/s1600/GlobalConditionsProject.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><span style="font-family: inherit;"><img border="0" data-original-height="671" data-original-width="775" height="552" src="https://3.bp.blogspot.com/-xTJqkIzjv-o/Wzs91TwnHgI/AAAAAAAABao/U3_weHKjSXk3WENhbsHhPdQENGGCmn9WwCLcBGAs/s640/GlobalConditionsProject.png" width="640" /></span></a><br /><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><br /><div><span style="font-family: inherit;"><br /></span></div><div><span style="font-family: inherit;">#Get process TSManager; will issue true if within a Task Sequence</span></div><div><span style="font-family: inherit;">[bool] (Get-Process TSmanager -ea 0)</span></div><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-RgySQzOW0pg/Wzs9QRYcoQI/AAAAAAAABag/SrbpYWUJGgEQcXj3ykXInQYWZfar0i_eQCLcBGAs/s1600/GlobalConditions3.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><span style="font-family: inherit;"><img border="0" data-original-height="665" data-original-width="675" height="630" src="https://3.bp.blogspot.com/-RgySQzOW0pg/Wzs9QRYcoQI/AAAAAAAABag/SrbpYWUJGgEQcXj3ykXInQYWZfar0i_eQCLcBGAs/s640/GlobalConditions3.png" width="640" /></span></a></div><span style="font-family: inherit;"><br /></span></div><div><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><br /></span></div><div><br /></div></div>