---
layout: post
title: The Broadway Online Algorithm
tags: [online-algorithms]
---


This problem was initially posed to me in my Graduate Algorithms class this past spring. While the proof is simple, I do think it's pretty clever. If you've found yourself on this page for some reason, definitely try the problem yourself, and then feel free to check out the proof. 

Here was the initial problem: Bob wants to attend as many Broadway shows as possible. These tickets go on sale every day in the evening, when the shows for that day are released. She does not know what shows will be on sale in the future. Design a 2 competitive deterministic online algorithm that maximizes the number of shows that Bob attends. Formally on day $t$, the algorithm receives set $S_t$ with the list of shows available on that day. That algorithm may choose a show from the list $S_t$ and buy a ticket to the given show. 

The solution: You'll quickly realize with some intuition that most choices of ticket strategies are 2 competitive, but the question really becomes how do you do prove it. I went down rabbit holes of different decision trees and graph based proofs before actually realizing the more clever approach. Keep in mind that this isn't a randomized algorithm, so there isn't much variability in choices that you can pick to improve performance. 

Let $ALG$ be the deterministic online algorithm that we design. $ALG$ follows a relatively simple rule, Alice can look at $S_t$ on any given day $t$ and should traverse $S_t$ and look for the first show that she has not seen before. In order to track all the shows that she has seen, she can use a hash map or a dictionary. To clarify, here's a short example. Let $S_1 = {A,B,C}, S_2 = {A}, S_3 = {A,C}$. On day 1, Alice will pick $A$, on day 2, she doesn't have any options because she has already seen $A$, on day 3, she will pick $C$. In this case, the $OPT$ algorithm picks $B,A,C$. Our goal is to show that for any case where there are $n$ days and $t \in {1,n}$, that $OPT$ can never exceed $ALG$ by a factor of two, given that we want to design a 2 competitive deterministic online algorithm. It is important to note, that $ALG$ is deterministic since there is no randomization in how it picks the movie to watch on day $t$. 

Let $A$ be the number of days that both $ALG$ and $OPT$ buy tickets. Let $B$ be the number of days when only $OPT$ buys tickets. We want to bound $ALG$ and $OPT$ in terms of $A$ and $B$ now. From here on, when assigning values to $ALG$ and $OPT$, I'm referring to the number of distinct shows that they were able to watch. We can bound $ALG$ and $OPT$ as follows given the definitions above:

\begin{center}
    $ALG \leq A$
\end{center}
\begin{center}
    $OPT \leq A+B$
\end{center}

We also want to understand the relationship between $A$ and $B$. Our goal is to design a 2 competitive algorithm, so given our bounds, the following must hold true.

\begin{center}
    $\frac{OPT}{ALG} \leq 2$
\end{center}
\begin{center}
    $\frac{A+B}{A} \leq 2$
\end{center}
\begin{center}
    $A+B \leq 2A$
\end{center}
\begin{center}
    $B \leq A$
\end{center}

Now, $S_i$ determines the list of shows that exist on day $i$ for Alice to pick from. Let $|S_i|$ be the total number of options that exist on day $i$. On some day $i$ such that $i \geq A+B $, there are three cases for $|S_i|$

\begin{equation}
    |S_i| \leq A
\end{equation}
\begin{equation}
     A < |S_i| \leq A + B
\end{equation}
\begin{equation}
    A+B < |S_i|
\end{equation}

In cases (2) and (3), A must increment by 1 since $ALG$ must see a new set as there are more options to pick from than $A$, so we are only interested in case (1) since that is the only case that can potentially break our condition that $B \leq A$. 

If $|S_i| \leq A$, then either there are options that $A$ has not seen before, in which case A will increment by 1, or all of the options are options that $ALG$ has previously picked before. So, we're primarily interested in the latter case. If all the options on $S_i$ have been previously picked by $ALG$, either all of these options have also previously been picked by $OPT$, or there are some options that $OPT$ has not picked yet. If this latter scenario happens when $A=B$, then we have broken our condition that $B \leq A$.

We are primarily interested in the case when $A=B$. If $|S_i| \leq A$, and all the options on $S_i$ have been picked by $ALG$, then all the options must have also been picked by $OPT$. Since, $A$ counts the number of days when both $ALG$ and $OPT$ have bought tickets, then $OPT$ has no new tickets to buy on $S_i$, as a result, $B$ cannot increment on this day since there are no new unique options for just $B$ to pick. So, we've proven that no matter the number of options, our condition $B \leq A$ holds no matter how many options there are in $S_i$


If you took the time to actually read through this, thanks a ton, and I hope you learned something from it too. 