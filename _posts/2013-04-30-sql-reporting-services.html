---
layout: post
title: SQL Reporting Services SCCM DCM
date: '2013-04-30T08:41:00.003-07:00'
author: syswow64
tags:
- sccmm
- DCM
- reporting services
modified_time: '2013-05-02T04:05:58.120-07:00'
thumbnail: http://2.bp.blogspot.com/-XrMKBWxWfVk/UX_lUSTJowI/AAAAAAAAA6g/df4Sm8TuZD0/s72-c/CompErrorNonComp.png
blogger_id: tag:blogger.com,1999:blog-4452544758446808584.post-8042455801096881504
blogger_orig_url: https://www.syswow64.co.uk/2013/04/sql-reporting-services.html
---

<span style="font-size: small;">This article is dedicated to providing working examples for DCM (Desired Configuration Managment) reports, using reporting services 2008.</span><br />
<span style="font-size: xx-small;"></span><br />
<span style="font-size: xx-small;"></span><br />
<span style="font-size: x-small;">1. This report displays three statenames for the baseline called BL - WK DCM.&nbsp; A count of Conpliance state populates the third column.</span><br />
<span style="font-size: xx-small;"></span><br />
<span style="font-size: xx-small;">SELECT&nbsp;&nbsp;&nbsp;&nbsp; CIProp.DisplayName AS 'DCM Baseline Name', SNames.StateName, COUNT(CCS.ComplianceState) AS 'Compliance State Count'<br />FROM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbo.v_BaselineTargetedComputers AS BTC INNER JOIN<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbo.v_ConfigurationItems AS CI ON CI.CI_ID = BTC.CI_ID INNER JOIN<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbo.v_CICurrentComplianceStatus AS CCS ON CCS.CI_ID = CI.CI_ID AND CCS.ResourceID = BTC.ResourceID INNER JOIN<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbo.v_LocalizedCIProperties_SiteLoc AS CIProp ON CIProp.CI_ID = CI.CI_ID INNER JOIN<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbo.v_StateNames AS SNames ON CCS.ComplianceState = SNames.StateID<br />WHERE&nbsp;&nbsp;&nbsp;&nbsp; (CIProp.DisplayName = 'BL - WK DCM') AND (SNames.TopicType = 401)<br />GROUP BY CIProp.DisplayName, CCS.ComplianceState, SNames.StateName</span><br />
<div class="separator" style="clear: both; text-align: center;">
<br /></div>
<div style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;">
<img border="0" src="http://2.bp.blogspot.com/-XrMKBWxWfVk/UX_lUSTJowI/AAAAAAAAA6g/df4Sm8TuZD0/s1600/CompErrorNonComp.png" height="68" width="320" /></div>
<div align="left">
&nbsp;</div>
<div align="left">
&nbsp;</div>
<div align="left">
&nbsp;</div>
<div align="left">
&nbsp;</div>
<div align="left">
2. This report displays Computer name with corresponding last logged on username, for machines with non compliant status for specific baseline.<br />
<span style="font-size: xx-small;">SELECT&nbsp;&nbsp;&nbsp;&nbsp; TOP (100) PERCENT SYS.Name0 AS 'Computer Name', SNames.StateName AS 'Compliance State', <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CCS.LastComplianceMessageTime AS 'Last Compliance Evaluation', SYS.User_Name0 AS 'User Name', OS.Caption0 AS 'Operating System', <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OS.InstallDate0 AS 'Install Date', STATUS.LastHWScan AS 'Last HW Scan', COMP.Model0 AS 'Model', CIProp.DisplayName, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CI.CIVersion AS 'Baseline Content Version'<br />FROM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbo.v_BaselineTargetedComputers AS BTC INNER JOIN<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbo.v_R_System AS SYS ON SYS.ResourceID = BTC.ResourceID INNER JOIN<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbo.v_GS_COMPUTER_SYSTEM AS COMP ON COMP.ResourceID = BTC.ResourceID INNER JOIN<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbo.v_GS_OPERATING_SYSTEM AS OS ON OS.ResourceID = SYS.ResourceID INNER JOIN<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbo.v_ConfigurationItems AS CI ON CI.CI_ID = BTC.CI_ID INNER JOIN<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbo.v_CICurrentComplianceStatus AS CCS ON CCS.CI_ID = CI.CI_ID AND CCS.ResourceID = BTC.ResourceID INNER JOIN<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbo.v_LocalizedCIProperties_SiteLoc AS CIProp ON CIProp.CI_ID = CI.CI_ID INNER JOIN<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbo.v_StateNames AS SNames ON CCS.ComplianceState = SNames.StateID LEFT OUTER JOIN<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbo.v_GS_WORKSTATION_STATUS AS STATUS ON STATUS.ResourceID = SYS.ResourceID LEFT OUTER JOIN<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbo.v_R_User AS USR ON USR.User_Name0 = SYS.User_Name0<br />WHERE&nbsp;&nbsp;&nbsp;&nbsp; (CIProp.DisplayName = 'BL - WK DCM') AND (SNames.TopicType = 401) AND (SNames.StateName &lt;&gt; 'Compliant')<br />ORDER BY 'Compliance State'</span><br />
<span style="font-size: xx-small;"></span><br />
<span style="font-size: xx-small;"><em>NOTE: Change WHERE for compliant machines</em></span><br />
<span style="font-size: xx-small;"><em>WHERE&nbsp;&nbsp;&nbsp;&nbsp; (CIProp.DisplayName = 'BL -WK DCM') AND (SNames.TopicType = 401) AND (SNames.StateName &lt;&gt; 'Non-Compliant') AND <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (SNames.StateName &lt;&gt; 'error')</em></span></div>
<div align="left">
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="http://4.bp.blogspot.com/-HqthZximkwY/UX_oIzrGfpI/AAAAAAAAA6w/wPm6LhMtrIU/s1600/ComputerUserNonComp.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-HqthZximkwY/UX_oIzrGfpI/AAAAAAAAA6w/wPm6LhMtrIU/s1600/ComputerUserNonComp.png" height="27" width="640" /></a></div>
</div>
<div align="left">
<br />
This <br />
<br />
<span style="font-size: xx-small;">S</span><span style="font-size: xx-small;">ELECT DISTINCT <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TOP (100) PERCENT SYS.Name0, ccs.LastComplianceMessageTime, ccs.ComplianceStateName, dbo.v_LocalizedCIProperties_SiteLoc.DisplayName, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SYS.User_Name0, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CASE WHEN dbo.v_RA_System_SystemOUName.System_OU_Name0 LIKE '%Europe%' THEN 'EMEA' WHEN dbo.v_RA_System_SystemOUName.System_OU_Name0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LIKE '%Asia Pacific%' THEN 'APAC' WHEN dbo.v_RA_System_SystemOUName.System_OU_Name0 LIKE '%Brazil%' THEN 'LAC' WHEN dbo.v_RA_System_SystemOUName.System_OU_Name0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LIKE '%Hispanic LAC%' THEN 'LAC' WHEN dbo.v_RA_System_SystemOUName.System_OU_Name0 LIKE '%Canada%' THEN 'NA' WHEN dbo.v_RA_System_SystemOUName.System_OU_Name0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LIKE '%Northern%' THEN 'NA' WHEN dbo.v_RA_System_SystemOUName.System_OU_Name0 LIKE '%Southern%' THEN 'NA' WHEN dbo.v_RA_System_SystemOUName.System_OU_Name0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LIKE '%Western%' THEN 'NA' WHEN dbo.v_RA_System_SystemOUName.System_OU_Name0 LIKE '%Americas%' THEN 'Americas' ELSE 'MISC' END AS<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RegionOUCodeGrouped, dbo.v_GS_OPERATING_SYSTEM.Caption0, dbo.v_GS_OPERATING_SYSTEM.InstallDate0, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbo.v_GS_COMPUTER_SYSTEM.Model0<br />FROM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbo.v_CICurrentComplianceStatus AS ccs INNER JOIN<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbo.v_R_System AS SYS ON ccs.ResourceID = SYS.ResourceID INNER JOIN<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbo.v_LocalizedCIProperties_SiteLoc ON ccs.CI_ID = dbo.v_LocalizedCIProperties_SiteLoc.CI_ID INNER JOIN<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbo.v_RA_System_SystemOUName ON SYS.ResourceID = dbo.v_RA_System_SystemOUName.ResourceID INNER JOIN<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbo.v_GS_OPERATING_SYSTEM ON SYS.ResourceID = dbo.v_GS_OPERATING_SYSTEM.ResourceID INNER JOIN<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbo.v_GS_COMPUTER_SYSTEM ON SYS.ResourceID = dbo.v_GS_COMPUTER_SYSTEM.ResourceID<br />WHERE&nbsp;&nbsp;&nbsp;&nbsp; (dbo.v_LocalizedCIProperties_SiteLoc.DisplayName LIKE 'CI%') AND (ccs.ComplianceStateName = 'Compliant') AND <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (dbo.v_RA_System_SystemOUName.System_OU_Name0 &lt;&gt; 'OPS.Domain.COM/AMERICAS')<br />ORDER BY dbo.v_LocalizedCIProperties_SiteLoc.DisplayName</span></div>
<div class="separator" style="clear: both; text-align: center;">
<a href="http://4.bp.blogspot.com/-u7z9is2z2fc/UYEgpQCKGTI/AAAAAAAAA7A/jmvg8fOOZ6s/s1600/ComputerUserOU.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-u7z9is2z2fc/UYEgpQCKGTI/AAAAAAAAA7A/jmvg8fOOZ6s/s1600/ComputerUserOU.png" height="30" width="640" /></a></div>
<a href="http://4.bp.blogspot.com/-u7z9is2z2fc/UYEgpQCKGTI/AAAAAAAAA7A/jmvg8fOOZ6s/s1600/ComputerUserOU.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"></a><br />
<a href="http://4.bp.blogspot.com/-u7z9is2z2fc/UYEgpQCKGTI/AAAAAAAAA7A/jmvg8fOOZ6s/s1600/ComputerUserOU.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"></a><br />
<a href="http://4.bp.blogspot.com/-u7z9is2z2fc/UYEgpQCKGTI/AAAAAAAAA7A/jmvg8fOOZ6s/s1600/ComputerUserOU.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><div style="text-align: left;" unselectable="on">
&nbsp;</div>
</a><br />
<br />