---
layout: post
title: Office 365 Activation Troubleshooter SCCM Application
date: '2018-06-06T06:26:00.000-07:00'
author: syswow64
tags:
- Application
- SCCM
- Azure
- powershell
- configmgr
- Detection Method
- Office 365
- Activation
modified_time: '2020-01-17T04:20:26.739-08:00'
thumbnail: https://2.bp.blogspot.com/-KA0YYK8SiBs/WxfbFcK7P7I/AAAAAAAABY4/m5F2QB9Rum8bszP-Og1m984vYtftmIgjACLcBGAs/s72-c/Office365ActivationTroubleshooter.png
blogger_id: tag:blogger.com,1999:blog-4452544758446808584.post-3231779350819627081
blogger_orig_url: https://www.syswow64.co.uk/2018/06/office-365-activation-troubleshooter.html
---

<b>Scenario: </b>I wanted to package the&nbsp;Office 365 Activation Troubleshooter (<a href="https://support.office.com/en-us/article/unlicensed-product-and-activation-errors-in-office-0d23d3c0-c19c-4b2f-9845-5344fedc4380" target="_blank">Officeact.diagcab</a>) for Office 365 users with activation issues. I needed to find out the commands to use as well as the appropriate Detection Method.<br /><br /><br /><b>1. Download:</b> Officeact.diagcab <a href="https://aka.ms/diag_officeact">https://aka.ms/diag_officeact</a><br /><br /><b>2. </b>Create a PowerShell (Diagnostics.Office365.ps1) script to call the officeact.diagcab file. See example below<br /><br /><script src="https://gist.github.com/systemcenterblog/1151782ba38d4b558445e0384d58f783.js"></script> <b>3. </b>Create an SCCM Script application calling the Diagnostics.Office365.ps1 script<br /><br />powershell -ExecutionPolicy Bypass .\Diagnostics.Office365.ps1<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-KA0YYK8SiBs/WxfbFcK7P7I/AAAAAAAABY4/m5F2QB9Rum8bszP-Og1m984vYtftmIgjACLcBGAs/s1600/Office365ActivationTroubleshooter.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="592" data-original-width="643" src="https://2.bp.blogspot.com/-KA0YYK8SiBs/WxfbFcK7P7I/AAAAAAAABY4/m5F2QB9Rum8bszP-Og1m984vYtftmIgjACLcBGAs/s1600/Office365ActivationTroubleshooter.png" /></a></div><br />Select the Detection Method tab and select radial next to "Use a custom script to detect the presence of the this deployment type".<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-yz55OEpirKw/Wxfbyv0jaOI/AAAAAAAABZA/SZIthmj_yA84HZq5X8gZq1Wy3ulXQjjNQCLcBGAs/s1600/Office365ActivationTroubleshooter2.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="596" data-original-width="643" src="https://2.bp.blogspot.com/-yz55OEpirKw/Wxfbyv0jaOI/AAAAAAAABZA/SZIthmj_yA84HZq5X8gZq1Wy3ulXQjjNQCLcBGAs/s1600/Office365ActivationTroubleshooter2.png" /></a></div><br />Select the Edit option on the right and set the script type to PowerShell and the script content as appropriate to the application.<br /><br />The script below will look at all running processes and filter out all processes that equal msdt; if a process matching this string is found the client will return an exit code of 0 (zero) indicating to SCCM that the application has been detected.<br /><script src="https://gist.github.com/systemcenterblog/ca44cde01c1da6356ec504ed2f2f11d6.js"></script> <br /><br />Once the process terminates at the end of the diagnostics process the SCCM Client Application deployment cycle action will rerun making the application available for installation again without issuing a failed message.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-6aASMdTuJb0/WxfeLkUT83I/AAAAAAAABZM/0jti8MY4rHcWklBB8dqO7kdH8CszX3ySQCLcBGAs/s1600/Office365ActivationTroubleshooter3.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="687" data-original-width="641" src="https://4.bp.blogspot.com/-6aASMdTuJb0/WxfeLkUT83I/AAAAAAAABZM/0jti8MY4rHcWklBB8dqO7kdH8CszX3ySQCLcBGAs/s1600/Office365ActivationTroubleshooter3.png" /></a></div><br />The User Experience Tab should be set to "Install for User" as this diagcab must be run interactive in order to process the diagnostics.&nbsp; The installation program visibility should be set to Hidden otherwise the initial PowerShell script will be displayed detailing the Transcript etc.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-gd9BR0FnueA/Wxff1YDu2cI/AAAAAAAABZY/1ylkAe8iO4EXnFvcN4M7SkbNwumATI_zACLcBGAs/s1600/Office365ActivationTroubleshooter4.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="592" data-original-width="645" src="https://1.bp.blogspot.com/-gd9BR0FnueA/Wxff1YDu2cI/AAAAAAAABZY/1ylkAe8iO4EXnFvcN4M7SkbNwumATI_zACLcBGAs/s1600/Office365ActivationTroubleshooter4.png" /></a></div><br />