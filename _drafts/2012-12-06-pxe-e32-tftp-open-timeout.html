---
layout: post
title: 'PXE-E32: TFTP Open Timeout'
date: '2012-12-06T05:59:00.000-08:00'
author: syswow64
tags:
- computer
- technology
- MDT
- server 2008
- enterprise-it
- WDS
- business
- windows 7
- sccm
modified_time: '2012-12-31T06:39:52.180-08:00'
blogger_id: tag:blogger.com,1999:blog-4452544758446808584.post-468215713737237957
blogger_orig_url: https://www.syswow64.co.uk/2012/12/pxe-e32-tftp-open-timeout.html
---

<strong>SYMPTOM</strong><br/><br/>When the PXE client comes up with the PXE copyright message and<br/>completes the DHCP phase, but then displays:<br/><br/>TFTP....<br/><br/>After a<br/>while, the following error message is displayed:<br/><br/>PXE-E32: TFTP open timeout<br/><br/>Depending on the PXE client's system setup boot device list<br/>configuration, the PC then either stops or tries to boot from the next boot<br/>device in the system setup boot device list.<br/><br/><strong>CAUSE 1</strong><br/><br/>The "PXE-E32" error indicates that the PXE did not get a reply from the TFTP server when sending a request to download its boot file. Possible causes for this problem<br/>are:<br/><br/>1. There is no TFTP server<br/>2. The TFTP server is not running<br/>3. TFTP and DHCP/BOOTP services are running on different machines, but the next-server (066) option was not specified<br/><br/><strong>RESOLUTION 1</strong><br/><br/>Make sure that a TFTP server is set up and running. When the TFTP service is running<br/>on a different machine than the DHCP or BOOTP service, you need to add option<br/>066 (next-server) to the DHCP/BOOTP server configuration, and set this option's<br/>value to the IP address or "resolvable hostname" of the TFTP server. When option<br/>066 (next-server) is not defined, the PXE client assumes that the TFTP service<br/>is running on the same machine from which it received its DHCP/BOOTP<br/>configuration information.<br/><br/><strong>CAUSE 2</strong><br/><br/>This problem occurs after you apply security update MS08-037.  For more information, click the following article number to view the article in the Microsoft Knowledge Base:<br/><div><a href="/kb/953230">953230</a><br/><div>      (<a href="http://support.microsoft.com/kb/953230">http://support.microsoft.com/kb/953230</a> )</div><br/>MS08-037: Vulnerabilities in DNS could allow spoofing<br/><br/></div><br/><strong>RESOLUTION 2</strong><br/><h3 id="tocHeadRef">Windows Server 2008 R2</h3><br/><b>Important</b> This section, method, or task contains steps that tell you how to modify the registry. However, serious problems might occur if you modify the registry incorrectly. Therefore, make sure that you follow these steps carefully. For added protection, back up the registry before you modify it. Then, you can restore the registry if a problem occurs. For more information about how to back up and restore the registry, click the following article number to view the article in the Microsoft Knowledge Base:<br/><div><a href="/kb/322756">322756</a><br/><div>      (http://support.microsoft.com/kb/322756/            )</div><br/>How to back up and restore the registry in Windows<br/><br/></div><br/>To work around this problem if you do not require Windows Deployment Services to use a static port range, you can configure Windows Deployment Services to dynamically query WinSock for available ports instead of using a port range.<br/>To do this, follow these steps:<br/><ol><br/>	<li>Start Registry Editor. To do this, click <strong>Start </strong><br/><div><br/><div>Collapse this imageExpand this image , type regedit in the <strong>Start Search</strong> box, and then press ENTER.</div><br/></div><br/><div><br/><div>Collapse this imageExpand this image</div><br/><div></div><br/></div><br/>If you are prompted for an administrator password or for confirmation, type the password or provide confirmation.</li><br/>	<li>Locate and then click to select the following registry key:<br/><div><br/><div>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\WDSServer\Parameters</div><br/></div></li><br/>	<li>Right-click <strong>UdpPortPolicy</strong>, and then click <strong>Modify</strong>.</li><br/>	<li>In the <strong>Value data</strong> box, type 0, and then click <strong>OK</strong>.</li><br/>	<li>On the <strong>File</strong> menu, click <strong>Exit</strong> to exit Registry Editor.</li><br/>	<li>Restart Windows Deployment Services.</li><br/>	<li></li><br/></ol><br/><strong>WDS logging can be enabled by editing the value of this registry key and setting </strong><strong>it to</strong><br/>1:<br/><br/>HKLM\SOFTWARE\Microsoft\Tracing\WDSSERVER\EnableFileTracing<br/><br/>This then logs to %WINDIR%\tracing\WDSServer.log<br/><br/>One thing which can go wrong with TFTP is that WDS tries to use a temporary range of UDP ports, if any of these are already in use instead of nicely failing the connection and trying again on another port it simply borks, and fails, silently (unless you enable<br/>the log...)<br/><br/>The logging in question is:<br/><br/>[8436] 12:01:36:<br/>[698808][WDSPXE] [WDSPXE][UDP][Ep:10.10.0.11:4011] Sent To:10.10.0.114:68<br/>Len:1024<br/>[8436] 12:01:36:<br/>[d:\longhorn\base\ntsetup\opktools\wds\wdssrv\server\src\udphandler.cpp:369]<br/>Expression: , Win32 Error=2<br/>[8436] 12:01:36: [WDSTFTP][UDP][Ep=0]<br/>Registration Failed (rc=2)<br/>[8436] 12:01:36:<br/>[d:\longhorn\base\ntsetup\opktools\wds\wdssrv\server\src\ifhandler.cpp:238]<br/>Expression: , Win32 Error=2<br/><br/>Oddly it seems that under "normal" operation<br/>you get a lot of these:<br/><br/>[9488] 12:42:17:<br/>[d:\longhorn\base\ntsetup\opktools\wds\wdssrv\server\src\udpendpoint.cpp:811]<br/>Expression: , Win32 Error=5023