---
layout: post
title: Sharepoint documents will not open in Word/Excel
date: '2017-03-20T01:37:00.000-07:00'
author: syswow64
tags:
modified_time: '2017-06-09T07:27:19.826-07:00'
thumbnail: https://4.bp.blogspot.com/-Dg01WAxe5qM/WM-VZpd5_ZI/AAAAAAAABRM/w93itGodpfoYUNXINV2Yx257C3Z3Ab33QCEw/s72-c/GPO1.png
blogger_id: tag:blogger.com,1999:blog-4452544758446808584.post-2803130061911370671
blogger_orig_url: https://www.syswow64.co.uk/2017/03/sharepoint-documents-will-not-open-in.html
---

<div style="margin-bottom: .0001pt; margin: 0cm;"><span style="font-family: &quot;calibri&quot; , sans-serif;"><span style="font-size: 14.6667px;"><b>Sharepoint documents will not open in Word/Excel</b></span></span></div><div style="margin-bottom: .0001pt; margin: 0cm;"><span style="font-family: &quot;calibri&quot; , sans-serif;"><span style="font-size: 14.6667px;"><b><br /></b></span></span></div><div style="margin-bottom: .0001pt; margin: 0cm;"><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;">Today I have been dealing with a very interesting Office 365 / SharePoint issue. It was reported that the Edit in Application button within SharePoint i.e. “Edit in Excel” “Edit in Word” is not working correctly and results in an empty Spreadsheet or empty Word document.<o:p></o:p></span></div><div style="margin-bottom: .0001pt; margin: 0cm;"><br /></div><div style="margin-bottom: .0001pt; margin: 0cm;"><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;">Viewing and Editing within the browser is fully functional and the behaviour varies depending on computers within specific OU in active directory.&nbsp; It is worth noting at this point the estate consisted of Office 2013 ProPlus installations running on Windows 8.1. <o:p></o:p></span></div><div style="margin-bottom: .0001pt; margin: 0cm;"><br /></div><div style="margin-bottom: .0001pt; margin: 0cm;"><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;">The fact that identical systems with identical software versions patch to the same level, resulted in different behaviour could only mean Group Policy was different between them.</span><br /><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;"><br /></span><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-Dg01WAxe5qM/WM-VZpd5_ZI/AAAAAAAABRM/w93itGodpfoYUNXINV2Yx257C3Z3Ab33QCEw/s1600/GPO1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="128" src="https://4.bp.blogspot.com/-Dg01WAxe5qM/WM-VZpd5_ZI/AAAAAAAABRM/w93itGodpfoYUNXINV2Yx257C3Z3Ab33QCEw/s640/GPO1.png" width="640" /></a></div><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;"><br /></span></div><div style="margin-bottom: .0001pt; margin: 0cm;"><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;">I was quickly able to find the offending policy; "<i>Block signing into Office: Enabled</i>". The screen shot above details a systems policy with the issue.<o:p></o:p></span></div><div style="margin-bottom: .0001pt; margin: 0cm;"><br /></div><div style="margin-bottom: .0001pt; margin: 0cm;"><br /></div><div style="margin-bottom: .0001pt; margin: 0cm;"><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;">With the Standard Workstation GPO's the policy "Block signing into Office: Enabled" is not configured and Office applications can see the Sign-In option and can login to Office 365.&nbsp; <o:p></o:p></span></div><div style="margin-bottom: .0001pt; margin: 0cm;"><div class="separator" style="clear: both; text-align: center;"><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"></a></div><br /></div><div style="margin-bottom: .0001pt; margin: 0cm;"><div class="separator" style="clear: both; text-align: center;"></div><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;">Upon logging into a domain joined system Microsoft Office will login by default with the same account used to login to the computer.&nbsp; If the account used to login to the computer ( i.e. SA_U1234567) is different from the account used to login to Office 365&nbsp; (i.e. U1234567) the application Excel will fail to authenticate.&nbsp; The Application will attempt to open the SharePoint URL intended for U1234567 and authenticate site/file; it will attempt to authenticate against the locally log on user ( i.e. SA_U1234567) who does not have permission and fail.&nbsp; <o:p></o:p></span></div><div style="margin-bottom: .0001pt; margin: 0cm;"><br /></div><div style="margin-bottom: .0001pt; margin: 0cm;"><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;">For example the SA_U1234567 will need to have permissions to the resource U1234567 has selected within the Office 365 portal to "Edit in Excel". If the account SA_U1234567 does not have rights Excel will present, the user with the following Information message.&nbsp; <b>"Sorry, we couldn't open <span class="MsoHyperlink">HTTPS://...SharePoint.com/Sites/…../Document.XLS</span>"</b></span><br /><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;"><b><br /></b></span><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><a href="https://3.bp.blogspot.com/-JeB8MqVYyP8/WM-VZcmsNqI/AAAAAAAABRI/mo7kU-SnD7A8T0SgR58m0OmJw3dRD5kxACEw/s1600/Info1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="128" src="https://3.bp.blogspot.com/-JeB8MqVYyP8/WM-VZcmsNqI/AAAAAAAABRI/mo7kU-SnD7A8T0SgR58m0OmJw3dRD5kxACEw/s640/Info1.png" width="640" /></a></div><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;"><b><br /></b></span></div><div style="margin-bottom: .0001pt; margin: 0cm;"><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;"><!--[if gte vml 1]><v:shape  id="Picture_x0020_2" o:spid="_x0000_i1027" type="#_x0000_t75" style='width:452.25pt;  height:90.75pt;visibility:visible;mso-wrap-style:square'> <v:imagedata src="file:///C:/Users/K1630678/AppData/Local/Temp/msohtmlclip1/01/clip_image003.png"   o:title=""/></v:shape><![endif]--><!--[if !vml]--><!--[endif]--></span><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;"><o:p></o:p></span></div><div style="margin-bottom: .0001pt; margin: 0cm;"><br /></div><div style="margin-bottom: .0001pt; margin: 0cm;"><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;">It will follow up with a Warning message explaining:<o:p></o:p></span></div><div style="margin-bottom: .0001pt; margin: 0cm;"><b><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;">Microsoft Excel cannot access the file '<span class="MsoHyperlink">HTTPS://...SharePoint.com/Sites/…../Document.XL</span>S".&nbsp; There are several possible reasons:<o:p></o:p></span></b></div><div style="margin-bottom: .0001pt; margin: 0cm;"><br /></div><div style="margin-bottom: .0001pt; margin: 0cm;"><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;">The message clearly explains that excel cannot access the file. Without an authenticated account the file will not be accessible; the first “<b>possible reasons</b>”, “<b>The File name or path does not exist</b>” is true from the perspective that Excel cannot find the file request. </span><!--[if gte vml 1]><v:shape id="picture" o:spid="_x0000_i1026"  type="#_x0000_t75" style='width:450.75pt;height:111.75pt;visibility:visible;  mso-wrap-style:square'> <v:imagedata src="file:///C:/Users/K1630678/AppData/Local/Temp/msohtmlclip1/01/clip_image004.png"   o:title=""/></v:shape><![endif]--><!--[if !vml]--><!--[endif]--><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;"><o:p></o:p></span></div><div style="margin-bottom: .0001pt; margin: 0cm;"><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-HjCuh3C-iPg/WM-VZwSE2CI/AAAAAAAABRU/w_ylsKee14ENKiZ42k384EPmx1aLLJVWQCEw/s1600/warning1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="156" src="https://2.bp.blogspot.com/-HjCuh3C-iPg/WM-VZwSE2CI/AAAAAAAABRU/w_ylsKee14ENKiZ42k384EPmx1aLLJVWQCEw/s640/warning1.png" width="640" /></a></div><br /></div><div style="margin-bottom: .0001pt; margin: 0cm;"><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;">If the account used to login to the computer is U1234567 and Office 365 /SharePoint is authenticated with the account U1234567 then the “Edit in Excel” will pass the MS-Excel Protocol a site URL that can be authenticated; resulting in success.<o:p></o:p></span></div><div style="margin-bottom: .0001pt; margin: 0cm;"><br /></div><div style="margin-bottom: .0001pt; margin: 0cm;"><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;">The Workstation that was unable to “Edit in Excel”&nbsp; was applying the policy "Block signing into Office : Enabled". This configuration blocks the ability for the Microsoft Application to Sign-in; Excel was not able even attempting to authenticate against Office 365.&nbsp; <o:p></o:p></span></div><div style="margin-bottom: .0001pt; margin: 0cm;"><br /></div><div style="margin-bottom: .0001pt; margin: 0cm;"><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;">Within Office 365/SharePoint when the button is clicked to "<b>Edit in Excel</b>" essentially the user is&nbsp; initiating a hyperlink calling the protocol MS-Excel with the full URL to the resource.<o:p></o:p></span></div><div style="margin-bottom: .0001pt; margin: 0cm;"><br /></div><div style="margin-bottom: .0001pt; margin: 0cm;"><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;">ms-excel:ofv|u|https://....sharepoint.com/sites/......EXCELFILE.xlsx<o:p></o:p></span></div><div style="margin-bottom: .0001pt; margin: 0cm;"><br /></div><div style="margin-bottom: .0001pt; margin: 0cm;"><br /></div><div style="margin-bottom: .0001pt; margin: 0cm;"><div class="separator" style="clear: both; text-align: center;"></div><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;"><!--[if gte vml 1]><v:shape  id="Picture_x0020_1" o:spid="_x0000_i1025" type="#_x0000_t75" alt="Machine generated alternative text:&#10;Edit Workbook &#10;: Edit in Excel &#10;Share &#10;use the full functionality of Microsoft &#10;- Edit in Browser &#10;Make quick changes right here using &#10;Excel Online. "  style='width:231.75pt;height:132pt;visibility:visible;mso-wrap-style:square'> <v:imagedata src="file:///C:/Users/K1630678/AppData/Local/Temp/msohtmlclip1/01/clip_image006.png"   o:title=" Edit in Excel &#10;Share &#10;use the full functionality of Microsoft &#10;- Edit in Browser &#10;Make quick changes right here using &#10;Excel Online"/></v:shape><![endif]--><!--[if !vml]--><!--[endif]--></span><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;"><o:p></o:p></span></div><div style="margin-bottom: .0001pt; margin: 0cm;"><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-BWyC_a1UU7o/WM-VZcisCxI/AAAAAAAABRU/L4fIPUS7egE-TTx7p7wUzRLGLYs1K1-cACEw/s1600/EditInexcel1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="227" src="https://1.bp.blogspot.com/-BWyC_a1UU7o/WM-VZcisCxI/AAAAAAAABRU/L4fIPUS7egE-TTx7p7wUzRLGLYs1K1-cACEw/s400/EditInexcel1.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;"><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"></a></div><div class="separator" style="clear: both; text-align: center;"><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"></a></div><div class="separator" style="clear: both; text-align: center;"><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"></a></div><div class="separator" style="clear: both; text-align: center;"><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"></a></div><div class="separator" style="clear: both; text-align: center;"><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"></a></div><div class="separator" style="clear: both; text-align: center;"><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"></a></div><div class="separator" style="clear: both; text-align: center;"><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"></a></div><div class="separator" style="clear: both; text-align: center;"><a href="https://www.blogger.com/blogger.g?blogID=6577251125004095309" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"></a></div><br /></div><div style="margin-bottom: .0001pt; margin: 0cm;"><br /></div><div style="margin-bottom: .0001pt; margin: 0cm;"><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;">In the case of the Workstation that was unable to “Edit in Excel” the protocol for ms-excel opens Excel (set through File Association) and the URL is ignored. As the Sign-In is block Excel does not even attempt to find the SharePoint site and the user simply see a blank Excel spreadsheet.&nbsp; It is unfortunate that the User does not get a dialogue box explaining the Sign-In is block and is left to believe the operating failed.&nbsp; <o:p></o:p></span></div><div style="margin-bottom: .0001pt; margin: 0cm;"><br /></div><div style="margin-bottom: .0001pt; margin: 0cm;"><b><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;">Conclusion<o:p></o:p></span></b></div><div style="margin-bottom: .0001pt; margin: 0cm;"><span style="font-family: &quot;calibri&quot; , sans-serif; font-size: 11.0pt;">It is worth noting that If you are seeing the Information and Warning dialogue boxes your issue will most likely relate to Authentication and access to the resource.&nbsp; If you are presented with an empty Excel or Word document then Policy is a root of investigation.</span><o:p></o:p></div><br /><div style="margin-bottom: .0001pt; margin: 0cm;"><div class="separator" style="clear: both; text-align: center;"></div><br /></div>