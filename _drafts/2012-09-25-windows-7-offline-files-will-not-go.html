---
layout: post
title: Windows 7 Offline files will not go Online when connected to network
date: '2012-09-25T07:22:00.000-07:00'
author: syswow64
tags:
- server 2008
- enterprise-it
- windows
- sync online offline files
- windows 7
modified_time: '2012-12-31T06:42:36.361-08:00'
blogger_id: tag:blogger.com,1999:blog-4452544758446808584.post-3608582427491756145
blogger_orig_url: https://www.syswow64.co.uk/2012/09/windows-7-offline-files-will-not-go.html
---

<strong>Issue</strong><br/><br/>Several laptop users move between networks, domain, home, etc and when they attempt to access DFS shares explorer status is working offline.  The issue only resolves it self after a reboot. Connecting directly to the share works and i am able to ping network resources.  This behavior occurs for VPN users as well.<br/><br/><strong>Possible Causes</strong><br/><br/>"slow-link mode". In win7 (with default settings) a client will enter slow-link mode if the latency to the server is above 80ms. In slow-link mode all writes are made to the local cache and a background sync only happens every 6 hours.  Depending on your connection the default slow link detection speed is 64,000 bps<br/><br/>On client computers running Windows 7 or Windows Server 2008 R2, a shared folder automatically transitions to the slow-link mode if the round-trip latency of the network is greater than 80 milliseconds, or as configured by the "Configure slow-link mode" policy. After transitioning a folder to the slow-link mode, Offline Files synchronizes the user's files in the background at regular intervals, or as configured by the 'Configure Background Sync' policy. While in slow-link mode, Windows periodically checks the connection to the folder and brings the folder back online if network speeds improve.<br/><br/>If you do not configure the "Configure slow-link mode" policy setting, computers running Windows Vista or Windows Server 2008 will not transition a shared folder to the slow-link mode. Computers running Windows 7 or Windows Server 2008 R2 will use the default latency value of 80 milliseconds when transitioning a folder to the slow-link mode. To prevent computers running Windows 7 or Windows Server 2008 R2 from using the slow-link mode, disable this policy.<br/><br/><strong>Option 1</strong> Disable it in the Group policy to see if it helps (feedback welcome),<br/>Check the following two policy settings that control the offline file slow-link mode and speed:<br/>Path: Computer Policy\Administrative Templates\Network\Offline Files<br/>Policies:<br/><br/>*Configure slow-link mode<br/><br/>*Configure slow-link speed<br/><br/><strong>Option 2</strong> Configure Forced silent auto reconnection<br/><br/>1. Click Start, type REGEDIT in search bar, and then click OK.<br/><br/>2. Locate and click the following registry subkey:<br/>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\NetCache<br/><br/>3. Click Edit, point to New, and then click DWORD Value.<br/><br/>4. Type SilentForcedAutoReconnect, and then press ENTER to name the value.<br/><br/>5. Double-click SilentForcedAutoReconnect.<br/><br/>6. In the Value data box, type 1, and then click OK.<br/><br/><strong>Option3</strong> Computer Policy\Administrative Templates\Network\Offline Files\Action on server disconnect<br/><br/>Tip: To configure this setting without establishing a setting, in Windows Explorer, on the Tools menu, click Folder Options, click the Offline Files tab, click Advanced, and then select an option in the "When a network connection is lost" section.<br/><br/>Also, see the "Non-default server disconnect actions" setting.