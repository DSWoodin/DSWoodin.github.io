---
layout: post
title: SMS SCCM WDS MDT Windows 7
date: '2012-10-16T05:06:00.001-07:00'
author: syswow64
tags:
- MDT
- SCCM
- server 2008
- WDS
- SMS
- Windows 7
modified_time: '2020-01-17T04:20:30.336-08:00'
blogger_id: tag:blogger.com,1999:blog-4452544758446808584.post-2057598054489126978
blogger_orig_url: https://www.syswow64.co.uk/2012/10/sms-sccm-wds-mdt-windows-7_16.html
---

<h2>Tips- How to package software</h2><br/><h3>Switches</h3><br/>-r<br/>Causes Setup.exe automatically to generate a silent setup file (.iss file), which is a record of the setup input, in the Windows folder.<br/><br/>&nbsp;<br/><h2>Packages</h2><br/>cmd files must have drive letter<br/>more info at <a href="http://www.appdeploy.com/" rel="nofollow">http://www.appdeploy.com/</a><br/>tick "suppress program notifications" to stop systray bubble/add and remove programs<br/><br/>Useful silent (un)install code:<br/><ul><br/>	<li>msiexec /I "xxxx.msi" transforms="xxxx.mst" /qn /norestart (/qn shows no interface, /qb shows basic progress bar)</li><br/>	<li>msiexec /x "xxxx.msi" /qn /norestart</li><br/>	<li>C:\WINDOWS\IsUninst.exe -fC:\xxx\xxx.isu -a (-a is for silent)</li><br/></ul><br/><h1>IMAGEx</h1><br/>Enter “<b>imagex /info img_file</b>“, where “img_file” represents the location of the <b>WIM</b> file. You should see now the description of the <b>WIM file</b> as an XML file. The name of the tag for the <b>image number</b> is <b>IMAGE INDEX</b>.<br/><br/>Create a new folder where the image shall be mounted. This is the image path. Now, you can <b>mount the image</b>:<br/><br/><b>imagex /mount img_file img_number img_path</b><br/><br/><b>imagex /mountrw img_file img_number img_path</b><br/><br/>Once you’ve modified the image you can unmount it with this command:<br/><br/><b>imagex /unmount /commit img_path</b><br/><h1>DISM</h1><br/>dism /Mount-Wim /wimfile:d:\boot.wim /index:1 /MountDir:d:\mount<br/>or<br/>dism /Mount-Wim /wimfile:d:\boot.wim /index:2 /MountDir:d:\mount<br/>or<br/>dism /Mount-Wim /wimfile:d:\install.wim /index:3 /MountDir:d:\mount<br/><h4><a href="http://technet.microsoft.com/en-us/library/dd744360%28v=ws.10%29.aspx" rel="nofollow">http://technet.microsoft.com/en-us/library/dd744360%28v=ws.10%29.aspx</a></h4><br/>dism /Mount-Wim /wimfile:"E:\DeploymentShare\Operating Systems\Windows7x64-Aug12\Windows7x64.wim" /index:1 /MountDir:e:\mount<br/>dism /Unmount-Wim /MountDir:e:\mount /commit<br/>Dism /image:e:\mount /Set-UserLocale:EN-gb<br/>Dism /image:e:\mount /Set-UILang:EN-us<br/>Dism /image:e:\mount /Set-SysLocale:EN-gb<br/>Dism /image:e:\mount /Set-InputLocale:EN-gb<br/>Dism /image:e:\mount /Set-AllIntl:EN-gb<br/>Dism /image:e:\mount /Set-SKUIntlDefaults:EN-gb<br/><br/>&nbsp;<br/><div><br/><h2>Add Drivers to Vista Boot Image</h2><br/>1. Update the WDS boot image to include the new third-party network driver. To do this, follow these steps.<br/><br/>Note The following procedure assumes that the Windows Automated Installation Kit (AIK) is installed on the WDS server. If the Windows AIK is not installed on the WDS server, you can perform the same procedure on another computer that does have the Windows AIK installed. Then, map a network drive to the WDS server.<br/>a. On the WDS server, click Start, click Run, type wdsmgmt.msc, and then press OK.<br/>b. Under your WDS server, double-click Boot images.<br/>c. Right-click the boot image that you want, and then click Disable.<br/>d. Right-click the same boot image, click Properties, and then click General.<br/>e. Note the name and location of the boot image that is displayed in the File name box.<br/>f. At a command prompt, type the following:<br/>C:\program files\windows aik\tools\petools\copype.cmd x86 c:\windowspe-x86<br/>Note Keep this command prompt window open for the next step.<br/>Imagex /info o:\remoteinstall\boot\x86\images\kinstall.wim<br/>Notes<br/><ul><br/>	<li>Drive:\remoteinstall represents the path at which the Remoteinstall folder is installed.</li><br/>	<li>Boot.wim is the name of the boot image.<br/>g. Note the boot index number of the bootable image that is displayed. To identify the boot index number, locate the line that contains "boot index: X."</li><br/></ul><br/>Note X is the boot index number. The number indicates that image number X is marked as bootable and that the image is to be updated. The second image is the default image that you would typically modify. However, always verify which image is marked as bootable.<br/>h. At a command prompt, type the following:<br/>Imagex /mountrw Drive:\remoteinstall\boot\x86\images\boot.wim 2 mount<br/>peimg /inf=driver.inf mount\Windows<br/>imagex /unmount /commit mount<br/>Notes<br/><ul><br/>	<li>Drive:\remoteinstall represents the path at which the Remoteinstall folder is installed.</li><br/>	<li>Driver.inf is the name of the third-party driver.</li><br/>	<li>The Imagex /mountrw command mounts the specified image, with read/write permissions, to the specified directory.<br/>2. Enable the boot image on the WDS server. To do this, follow these steps:<br/>. On the WDS server, click Start, click Run, type wdsmgmt.msc, and then click OK.<br/>a. Under WDS server, double-click Boot images.<br/>b. Right-click the boot image that you want, and then click Enable.</li><br/></ul><br/>----<br/><div><br/><div><br/><div id="highlighter_89319"><br/><table border="0"><br/><tbody><br/><tr><br/><td><br/><div title="Hint: double-click to select code"><br/><div><code>copype.cmd x86 c:\windowspe-x86</code></div><br/><div></div><br/><div></div><br/><div><code>imagex /info O:\RemoteInstall\Boot\x86\Images\Kcapture.WIM</code></div><br/><div><code>imagex /mountrw O:\RemoteInstall\Boot\x86\Images\Kcapture.WIM </code><code>3</code> <code>mount</code></div><br/><div></div><br/><div><code>------------------------</code></div><br/><div><code>[ option1- one driver]</code></div><br/><div></div><br/><div><code>peimg /inf=</code><code>"[path to .inf]"</code> <code>/image=C:\windowspe-x86\mount</code></div><br/><div><code>-------------------------------------</code></div><br/><div><code>[ option2- multidriver]</code></div><br/><div></div><br/><div><code>for</code> <code>/R O:\RemoteInstall\driver_to_inject\network\</code><code>760</code><code>-</code><code>960</code><code>\</code><code>780</code> <code>%i in (*.inf) </code><code>do</code> <code>peimg /inf=%i c:\windowspe-x86\mount\windows\</code></div><br/><div><code>---------------------------------------------</code></div><br/><div></div><br/><div><code>imagex /unmount /commit C:\windowspe-x86\mount</code></div><br/><div></div><br/><div></div><br/><div><code>imagex /unmount /commit mount</code></div><br/><div></div><br/><div><code>----------</code></div><br/></div></td><br/></tr><br/></tbody><br/></table><br/></div><br/></div><br/></div><br/>&nbsp;<br/><br/></div><br/><div id="labels-section"><br/><div><b>Labels:</b><b> </b><br/><div id="labels-section-content"></div><br/></div><br/></div><br/><h1>Microsoft deployment Toolkit (MDT)</h1><br/>Instructions:<br/>These instructions are brief and hopefully a useful first step.<br/><br/>How to deploy and Windows server 2003 image to bare metal (set to capture the file at the end of the task sequence)<br/><br/>1 On the computer you wish to deploy an OS instance power on and press F12 when prompted.  Select network boot (PXE boot).  Be ready to press F12 again when prompted otherwise it will time out and proceed to the next item in the boot order. Proceeding will Format the computer and delete all data!<br/>2 Select 'Lite Touch Windows PE (x64)-Engineering' to pull down the WinPE file.<br/>3 This produces a MDT Wizard, enter your domain credentials.<br/>4 Select 'Microsoft Server 2003 Standard x64' from the task sequence.<br/>5 Complete the wizard and 'begin'.<br/>5.1 If you choose to capture the image after deployment specify the capture location as \\contoso\DeploymentShareEng$\captures<br/>6 Upon completion you will have Server 2003 installed (and if selected a captured image).<br/><br/>How to sysprep and capture a current image.<br/><br/>1 On the computer you wish to capture click Start &gt; Run and type \\contoso\DeploymentShareEng$\scripts\LiteTouch.vbs<br/>2 This produces a MDT Wizard, enter your domain credentials.<br/>3 Select 'sysprep and capture' from the task sequence.<br/>4 Save the capure to \\contoso\DeploymentShareEng$\captures<br/>5 Complete the wizard and 'begin'.<br/>6 Upon completion you will have a WIM file located in \\contoso\DeploymentShareEng$\captures which can be used in other task sequences.